<?xml version="1.0" encoding="UTF-8"?>
<library xmlns="urn:hl7-org:elm:r1" xmlns:t="urn:hl7-org:elm-types:r1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:fhir="http://hl7.org/fhir" xmlns:qdm43="urn:healthit-gov:qdm:v4_3" xmlns:qdm53="urn:healthit-gov:qdm:v5_3" xmlns:a="urn:hl7-org:cql-annotations:r1" localId="0">
   <annotation translatorVersion="3.11.0" translatorOptions="EnableAnnotations,EnableLocators,DisableListDemotion,DisableListPromotion" signatureLevel="Overloads" xsi:type="a:CqlToElmInfo"/>
   <annotation xsi:type="a:Annotation">
      <a:s r="1417">
         <a:s>library CSMCommonFunctions version '1.0.0'</a:s>
      </a:s>
   </annotation>
   <identifier id="CSMCommonFunctions" system="http://cancerscreeningcds.github.io/crcsm-cds" version="1.0.0"/>
   <schemaIdentifier id="urn:hl7-org:elm" version="r1"/>
   <usings>
      <def localId="1" localIdentifier="System" uri="urn:hl7-org:elm-types:r1"/>
      <def localId="206" locator="3:1-3:26" localIdentifier="FHIR" uri="http://hl7.org/fhir" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="206">
               <a:s>using </a:s>
               <a:s>
                  <a:s>FHIR</a:s>
               </a:s>
               <a:s> version '4.0.1'</a:s>
            </a:s>
         </annotation>
      </def>
   </usings>
   <includes>
      <def localId="207" locator="5:1-5:63" localIdentifier="C3F" path="http://cancerscreeningcds.github.io/crcsm-cds/CDSConnectCommonsforFHIRv401" version="1.0.0">
         <annotation xsi:type="a:Annotation">
            <a:s r="207">
               <a:s>include </a:s>
               <a:s>
                  <a:s>CDSConnectCommonsforFHIRv401</a:s>
               </a:s>
               <a:s> version '1.0.0' called C3F</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="208" locator="6:1-6:54" localIdentifier="FHIRHelpers" path="http://cancerscreeningcds.github.io/crcsm-cds/FHIRHelpers" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="208">
               <a:s>include </a:s>
               <a:s>
                  <a:s>FHIRHelpers</a:s>
               </a:s>
               <a:s> version '4.0.1' called FHIRHelpers</a:s>
            </a:s>
         </annotation>
      </def>
   </includes>
   <codeSystems>
      <def localId="209" locator="8:1-8:88" name="CONDVERSTATUS" id="http://terminology.hl7.org/CodeSystem/condition-ver-status" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="209">
               <a:s>codesystem &quot;CONDVERSTATUS&quot;: 'http://terminology.hl7.org/CodeSystem/condition-ver-status'</a:s>
            </a:s>
         </annotation>
      </def>
   </codeSystems>
   <codes>
      <def localId="210" locator="10:1-10:79" name="Condition Refuted code" id="refuted" display="Refuted" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="210">
               <a:s>code &quot;Condition Refuted code&quot;: 'refuted' from </a:s>
               <a:s r="211">
                  <a:s>&quot;CONDVERSTATUS&quot;</a:s>
               </a:s>
               <a:s> display 'Refuted'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="211" locator="10:47-10:61" name="CONDVERSTATUS"/>
      </def>
      <def localId="212" locator="11:1-11:106" name="Condition Entered in Error code" id="entered-in-error" display="Entered in Error" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="212">
               <a:s>code &quot;Condition Entered in Error code&quot;: 'entered-in-error' from </a:s>
               <a:s r="213">
                  <a:s>&quot;CONDVERSTATUS&quot;</a:s>
               </a:s>
               <a:s> display 'Entered in Error'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="213" locator="11:65-11:79" name="CONDVERSTATUS"/>
      </def>
   </codes>
   <concepts>
      <def localId="214" locator="13:1-13:75" name="Condition Refuted" display="Refuted" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="214">
               <a:s>concept &quot;Condition Refuted&quot;: { </a:s>
               <a:s r="215">
                  <a:s>&quot;Condition Refuted code&quot;</a:s>
               </a:s>
               <a:s> } display 'Refuted'</a:s>
            </a:s>
         </annotation>
         <code localId="215" locator="13:32-13:55" name="Condition Refuted code"/>
      </def>
      <def localId="216" locator="14:1-14:102" name="Condition Entered in Error" display="Entered in Error" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="216">
               <a:s>concept &quot;Condition Entered in Error&quot;: { </a:s>
               <a:s r="217">
                  <a:s>&quot;Condition Entered in Error code&quot;</a:s>
               </a:s>
               <a:s> } display 'Entered in Error'</a:s>
            </a:s>
         </annotation>
         <code localId="217" locator="14:41-14:73" name="Condition Entered in Error code"/>
      </def>
   </concepts>
   <statements>
      <def localId="218" locator="27:1-28:73" name="ConceptText" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="218">
               <a:s>/*******************************************************************************
 * NOTICE: This following code has been adapted from &quot;Factors to Consider in 
 * Managing Chronic Pain: A Pain Management Summary,&quot; available at:
 * https://cds.ahrq.gov/cdsconnect/artifact/factors-consider-managing-chronic-pain-pain-management-summary
 * It is made available via an Apache 2.0 license.
*******************************************************************************/

// Returns the first-found display text for a CodeableConcept, looking first at the `text` attribute, then the
// `display` on each `coding` until it finds a non-null value.  Some PEG codes are normalized due to length.
// @param c - a FHIR CodeableConcept to get text from
// @returns {System.String} the display text or null if none is found
define function ConceptText(c FHIR.CodeableConcept):
  </a:s>
               <a:s r="237">
                  <a:s r="237">
                     <a:s>Coalesce(</a:s>
                     <a:s r="223">
                        <a:s r="222">
                           <a:s r="221">
                              <a:s>c</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="222">
                              <a:s>text</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="223">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>, </a:s>
                     <a:s r="234">
                        <a:s>Coalesce(</a:s>
                        <a:s r="231">
                           <a:s>
                              <a:s r="224">
                                 <a:s r="226">
                                    <a:s>(</a:s>
                                    <a:s r="226">
                                       <a:s r="225">
                                          <a:s>c</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="226">
                                          <a:s>coding</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s> c2</a:s>
                              </a:s>
                           </a:s>
                           <a:s> </a:s>
                           <a:s r="227">
                              <a:s>return </a:s>
                              <a:s r="230">
                                 <a:s r="229">
                                    <a:s r="228">
                                       <a:s>c2</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="229">
                                       <a:s>display</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="230">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="237" locator="28:3-28:73" xsi:type="Coalesce">
            <operand localId="223" locator="28:12-28:23" path="value" xsi:type="Property">
               <source localId="222" locator="28:12-28:17" path="text" xsi:type="Property">
                  <source localId="221" locator="28:12" name="c" xsi:type="OperandRef"/>
               </source>
            </operand>
            <operand localId="234" locator="28:26-28:72" xsi:type="Coalesce">
               <operand localId="231" locator="28:35-28:71" xsi:type="Query">
                  <source localId="224" locator="28:35-28:47" alias="c2">
                     <expression localId="226" locator="28:35-28:44" path="coding" xsi:type="Property">
                        <source localId="225" locator="28:36" name="c" xsi:type="OperandRef"/>
                     </expression>
                  </source>
                  <return localId="227" locator="28:49-28:71">
                     <expression localId="230" locator="28:56-28:71" path="value" xsi:type="Property">
                        <source localId="229" locator="28:56-28:65" path="display" scope="c2" xsi:type="Property"/>
                     </expression>
                  </return>
               </operand>
            </operand>
         </expression>
         <operand localId="220" name="c">
            <operandTypeSpecifier localId="219" locator="27:31-27:50" name="fhir:CodeableConcept" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="238" locator="33:1-34:19" name="DateText" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="238">
               <a:s>// Returns a text representation of a date using the CQL `ToString` function.
// @param d - a FHIR date to get text for
// @returns {System.String} the text representation of the date
define function DateText(d FHIR.date):
  </a:s>
               <a:s r="246">
                  <a:s r="246">
                     <a:s>ToString(</a:s>
                     <a:s r="242">
                        <a:s r="241">
                           <a:s>d</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="242">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="246" locator="34:3-34:19" xsi:type="ToString">
            <signature localId="247" name="t:Date" xsi:type="NamedTypeSpecifier"/>
            <operand localId="242" locator="34:12-34:18" path="value" xsi:type="Property">
               <source localId="241" locator="34:12" name="d" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand localId="240" name="d">
            <operandTypeSpecifier localId="239" locator="33:28-33:36" name="fhir:date" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="248" locator="39:1-40:47" name="DateTimeText" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="248">
               <a:s>// Returns a text representation of a dateTime using the CQL `ToString` function.
// @param d - a FHIR dateTime to get text for
// @returns {System.String} the text representation of the date portion of the dateTime
define function DateTimeText(d FHIR.dateTime):
  </a:s>
               <a:s r="264">
                  <a:s r="264">
                     <a:s>First(</a:s>
                     <a:s r="261">
                        <a:s>SplitOnMatches(</a:s>
                        <a:s r="256">
                           <a:s>ToString(</a:s>
                           <a:s r="252">
                              <a:s r="251">
                                 <a:s>d</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="252">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>, </a:s>
                        <a:s r="258">
                           <a:s>'T'</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="264" locator="40:3-40:47" xsi:type="First">
            <source localId="261" locator="40:9-40:46" xsi:type="SplitOnMatches">
               <stringToSplit localId="256" locator="40:24-40:40" xsi:type="ToString">
                  <signature localId="257" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="252" locator="40:33-40:39" path="value" xsi:type="Property">
                     <source localId="251" locator="40:33" name="d" xsi:type="OperandRef"/>
                  </operand>
               </stringToSplit>
               <separatorPattern localId="258" locator="40:43-40:45" valueType="t:String" value="T" xsi:type="Literal"/>
            </source>
         </expression>
         <operand localId="250" name="d">
            <operandTypeSpecifier localId="249" locator="39:32-39:44" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="265" locator="45:1-46:19" name="InstantText" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="265">
               <a:s>// Returns a text representation of an instant using the CQL `ToString` function.
// @param i - a FHIR instant to get text for
// @returns {System.String} the text representation of the instant
define function InstantText(i FHIR.instant):
  </a:s>
               <a:s r="273">
                  <a:s r="273">
                     <a:s>ToString(</a:s>
                     <a:s r="269">
                        <a:s r="268">
                           <a:s>i</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="269">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="273" locator="46:3-46:19" xsi:type="ToString">
            <signature localId="274" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <operand localId="269" locator="46:12-46:18" path="value" xsi:type="Property">
               <source localId="268" locator="46:12" name="i" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand localId="267" name="i">
            <operandTypeSpecifier localId="266" locator="45:31-45:42" name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="275" locator="52:1-56:30" name="QuantityText" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="275">
               <a:s>// Returns a text representation of a Quantity with the Quantity's value and unit.
// If the unit is {score}, then omit it (as it is not useful to display)
// @param q - a FHIR Quantity to get text for
// @returns {System.String} the text representation of the Quantity
define function QuantityText(q FHIR.Quantity):
  </a:s>
               <a:s r="278">
                  <a:s r="278">
                     <a:s>if </a:s>
                     <a:s r="280">
                        <a:s>(</a:s>
                        <a:s r="280">
                           <a:s r="279">
                              <a:s>q</a:s>
                           </a:s>
                           <a:s> is null</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s r="281"> then null
  else </a:s>
                     <a:s r="282">
                        <a:s>if </a:s>
                        <a:s r="286">
                           <a:s>(</a:s>
                           <a:s r="286">
                              <a:s r="284">
                                 <a:s r="283">
                                    <a:s>q</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="284">
                                    <a:s>unit</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> is not null</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s> then </a:s>
                        <a:s r="306">
                           <a:s r="300">
                              <a:s r="295">
                                 <a:s>ToString(</a:s>
                                 <a:s r="291">
                                    <a:s r="290">
                                       <a:s r="289">
                                          <a:s>q</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="290">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="291">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s> + </a:s>
                              <a:s r="297">
                                 <a:s>' '</a:s>
                              </a:s>
                           </a:s>
                           <a:s> + </a:s>
                           <a:s r="303">
                              <a:s r="302">
                                 <a:s r="301">
                                    <a:s>q</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="302">
                                    <a:s>unit</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="303">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  else </a:s>
                        <a:s r="307">
                           <a:s>if </a:s>
                           <a:s r="311">
                              <a:s>(</a:s>
                              <a:s r="311">
                                 <a:s r="309">
                                    <a:s r="308">
                                       <a:s>q</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="309">
                                       <a:s>code</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> is not null</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s> then </a:s>
                           <a:s r="331">
                              <a:s r="325">
                                 <a:s r="320">
                                    <a:s>ToString(</a:s>
                                    <a:s r="316">
                                       <a:s r="315">
                                          <a:s r="314">
                                             <a:s>q</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="315">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="316">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s> + </a:s>
                                 <a:s r="322">
                                    <a:s>' '</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> + </a:s>
                              <a:s r="328">
                                 <a:s r="327">
                                    <a:s r="326">
                                       <a:s>q</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="327">
                                       <a:s>code</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="328">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
  else </a:s>
                           <a:s r="338">
                              <a:s>ToString(</a:s>
                              <a:s r="334">
                                 <a:s r="333">
                                    <a:s r="332">
                                       <a:s>q</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="333">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="334">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="278" locator="53:3-56:30" xsi:type="If">
            <condition localId="280" locator="53:6-53:16" xsi:type="IsNull">
               <operand localId="279" locator="53:7" name="q" xsi:type="OperandRef"/>
            </condition>
            <then localId="340" asType="t:String" xsi:type="As">
               <operand localId="281" locator="53:23-53:26" xsi:type="Null"/>
            </then>
            <else localId="282" locator="54:8-56:30" xsi:type="If">
               <condition localId="286" locator="54:11-54:30" xsi:type="Not">
                  <operand localId="285" locator="54:12-54:29" xsi:type="IsNull">
                     <operand localId="284" locator="54:12-54:17" path="unit" xsi:type="Property">
                        <source localId="283" locator="54:12" name="q" xsi:type="OperandRef"/>
                     </operand>
                  </operand>
               </condition>
               <then localId="306" locator="54:37-54:80" xsi:type="Concatenate">
                  <operand localId="300" locator="54:37-54:65" xsi:type="Concatenate">
                     <operand localId="295" locator="54:37-54:59" xsi:type="ToString">
                        <signature localId="296" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="291" locator="54:46-54:58" path="value" xsi:type="Property">
                           <source localId="290" locator="54:46-54:52" path="value" xsi:type="Property">
                              <source localId="289" locator="54:46" name="q" xsi:type="OperandRef"/>
                           </source>
                        </operand>
                     </operand>
                     <operand localId="297" locator="54:63-54:65" valueType="t:String" value=" " xsi:type="Literal"/>
                  </operand>
                  <operand localId="303" locator="54:69-54:80" path="value" xsi:type="Property">
                     <source localId="302" locator="54:69-54:74" path="unit" xsi:type="Property">
                        <source localId="301" locator="54:69" name="q" xsi:type="OperandRef"/>
                     </source>
                  </operand>
               </then>
               <else localId="307" locator="55:8-56:30" xsi:type="If">
                  <condition localId="311" locator="55:11-55:30" xsi:type="Not">
                     <operand localId="310" locator="55:12-55:29" xsi:type="IsNull">
                        <operand localId="309" locator="55:12-55:17" path="code" xsi:type="Property">
                           <source localId="308" locator="55:12" name="q" xsi:type="OperandRef"/>
                        </operand>
                     </operand>
                  </condition>
                  <then localId="331" locator="55:37-55:80" xsi:type="Concatenate">
                     <operand localId="325" locator="55:37-55:65" xsi:type="Concatenate">
                        <operand localId="320" locator="55:37-55:59" xsi:type="ToString">
                           <signature localId="321" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="316" locator="55:46-55:58" path="value" xsi:type="Property">
                              <source localId="315" locator="55:46-55:52" path="value" xsi:type="Property">
                                 <source localId="314" locator="55:46" name="q" xsi:type="OperandRef"/>
                              </source>
                           </operand>
                        </operand>
                        <operand localId="322" locator="55:63-55:65" valueType="t:String" value=" " xsi:type="Literal"/>
                     </operand>
                     <operand localId="328" locator="55:69-55:80" path="value" xsi:type="Property">
                        <source localId="327" locator="55:69-55:74" path="code" xsi:type="Property">
                           <source localId="326" locator="55:69" name="q" xsi:type="OperandRef"/>
                        </source>
                     </operand>
                  </then>
                  <else localId="338" locator="56:8-56:30" xsi:type="ToString">
                     <signature localId="339" name="t:Decimal" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="334" locator="56:17-56:29" path="value" xsi:type="Property">
                        <source localId="333" locator="56:17-56:23" path="value" xsi:type="Property">
                           <source localId="332" locator="56:17" name="q" xsi:type="OperandRef"/>
                        </source>
                     </operand>
                  </else>
               </else>
            </else>
         </expression>
         <operand localId="277" name="q">
            <operandTypeSpecifier localId="276" locator="52:32-52:44" name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="341" locator="61:1-67:5" name="PeriodObject" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="341">
               <a:s>// Returns a tuple containing a Period's start and end as text representations.
// @param p - a FHIR Period to get a tuple for
// @returns {Tuple&lt;Start System.String, End System.String>} the tuple representation of the Period
define function PeriodObject(p FHIR.Period):
  </a:s>
               <a:s r="344">
                  <a:s r="344">
                     <a:s>if </a:s>
                     <a:s r="346">
                        <a:s r="345">
                           <a:s>p</a:s>
                        </a:s>
                        <a:s> is null</a:s>
                     </a:s>
                     <a:s r="347"> then null
  else
    </a:s>
                     <a:s r="348">
                        <a:s>{
      </a:s>
                        <a:s>
                           <a:s>Start: </a:s>
                           <a:s r="351">
                              <a:s>DateTimeText(</a:s>
                              <a:s r="350">
                                 <a:s r="349">
                                    <a:s>p</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="350">
                                    <a:s>&quot;start&quot;</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s>
                           <a:s>End: </a:s>
                           <a:s r="354">
                              <a:s>DateTimeText(</a:s>
                              <a:s r="353">
                                 <a:s r="352">
                                    <a:s>p</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="353">
                                    <a:s>&quot;end&quot;</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
    }</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="344" locator="62:3-67:5" xsi:type="If">
            <condition localId="346" locator="62:6-62:14" xsi:type="IsNull">
               <operand localId="345" locator="62:6" name="p" xsi:type="OperandRef"/>
            </condition>
            <then localId="355" xsi:type="As">
               <operand localId="347" locator="62:21-62:24" xsi:type="Null"/>
               <asTypeSpecifier localId="356" xsi:type="TupleTypeSpecifier">
                  <element localId="357" name="Start">
                     <elementType localId="358" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  </element>
                  <element localId="359" name="End">
                     <elementType localId="360" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  </element>
               </asTypeSpecifier>
            </then>
            <else localId="348" locator="64:5-67:5" xsi:type="Tuple">
               <element name="Start">
                  <value localId="351" locator="65:14-65:36" name="DateTimeText" xsi:type="FunctionRef">
                     <operand localId="350" locator="65:27-65:35" path="start" xsi:type="Property">
                        <source localId="349" locator="65:27" name="p" xsi:type="OperandRef"/>
                     </operand>
                  </value>
               </element>
               <element name="End">
                  <value localId="354" locator="66:12-66:32" name="DateTimeText" xsi:type="FunctionRef">
                     <operand localId="353" locator="66:25-66:31" path="end" xsi:type="Property">
                        <source localId="352" locator="66:25" name="p" xsi:type="OperandRef"/>
                     </operand>
                  </value>
               </element>
            </else>
         </expression>
         <operand localId="343" name="p">
            <operandTypeSpecifier localId="342" locator="61:32-61:42" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="361" locator="72:1-78:5" name="RangeObject" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="361">
               <a:s>// Returns a tuple containing a Range's low and high as text representations.
// @param r - a FHIR Range to get a tuple for
// @returns {Tuple&lt;Low System.String, High System.String>} the tuple representation of the Range
define function RangeObject(r FHIR.Range):
  </a:s>
               <a:s r="364">
                  <a:s r="364">
                     <a:s>if </a:s>
                     <a:s r="366">
                        <a:s r="365">
                           <a:s>r</a:s>
                        </a:s>
                        <a:s> is null</a:s>
                     </a:s>
                     <a:s r="367"> then null
  else
    </a:s>
                     <a:s r="368">
                        <a:s>{
      </a:s>
                        <a:s>
                           <a:s>Low: </a:s>
                           <a:s r="371">
                              <a:s>QuantityText(</a:s>
                              <a:s r="370">
                                 <a:s r="369">
                                    <a:s>r</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="370">
                                    <a:s>low</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s>
                           <a:s>High: </a:s>
                           <a:s r="374">
                              <a:s>QuantityText(</a:s>
                              <a:s r="373">
                                 <a:s r="372">
                                    <a:s>r</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="373">
                                    <a:s>high</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
    }</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="364" locator="73:3-78:5" xsi:type="If">
            <condition localId="366" locator="73:6-73:14" xsi:type="IsNull">
               <operand localId="365" locator="73:6" name="r" xsi:type="OperandRef"/>
            </condition>
            <then localId="375" xsi:type="As">
               <operand localId="367" locator="73:21-73:24" xsi:type="Null"/>
               <asTypeSpecifier localId="376" xsi:type="TupleTypeSpecifier">
                  <element localId="377" name="Low">
                     <elementType localId="378" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  </element>
                  <element localId="379" name="High">
                     <elementType localId="380" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  </element>
               </asTypeSpecifier>
            </then>
            <else localId="368" locator="75:5-78:5" xsi:type="Tuple">
               <element name="Low">
                  <value localId="371" locator="76:12-76:30" name="QuantityText" xsi:type="FunctionRef">
                     <operand localId="370" locator="76:25-76:29" path="low" xsi:type="Property">
                        <source localId="369" locator="76:25" name="r" xsi:type="OperandRef"/>
                     </operand>
                  </value>
               </element>
               <element name="High">
                  <value localId="374" locator="77:13-77:32" name="QuantityText" xsi:type="FunctionRef">
                     <operand localId="373" locator="77:26-77:31" path="high" xsi:type="Property">
                        <source localId="372" locator="77:26" name="r" xsi:type="OperandRef"/>
                     </operand>
                  </value>
               </element>
            </else>
         </expression>
         <operand localId="363" name="r">
            <operandTypeSpecifier localId="362" locator="72:31-72:40" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="381" locator="80:1-87:3" name="ObservationDate" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="381">
               <a:s>define function ObservationDate(o FHIR.Observation):
  </a:s>
               <a:s r="413">
                  <a:s r="413">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="388">
                        <a:s r="384">
                           <a:s>(</a:s>
                           <a:s r="384">
                              <a:s r="386">
                                 <a:s r="385">
                                    <a:s>o</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="386">
                                    <a:s>effective</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="387">
                                 <a:s>FHIR.dateTime</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="388">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="393">
                        <a:s r="389">
                           <a:s>(</a:s>
                           <a:s r="389">
                              <a:s r="391">
                                 <a:s r="390">
                                    <a:s>o</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="391">
                                    <a:s>effective</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="392">
                                 <a:s>FHIR.instant</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="393">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="399">
                        <a:s r="398">
                           <a:s r="394">
                              <a:s>(</a:s>
                              <a:s r="394">
                                 <a:s r="396">
                                    <a:s r="395">
                                       <a:s>o</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="396">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="397">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="398">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="399">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="405">
                        <a:s r="404">
                           <a:s r="400">
                              <a:s>(</a:s>
                              <a:s r="400">
                                 <a:s r="402">
                                    <a:s r="401">
                                       <a:s>o</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="402">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="403">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="404">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="405">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="410">
                        <a:s r="406">
                           <a:s>(</a:s>
                           <a:s r="406">
                              <a:s r="408">
                                 <a:s r="407">
                                    <a:s>o</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="408">
                                    <a:s>issued</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="409">
                                 <a:s>FHIR.instant</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="410">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="413" locator="81:3-87:3" xsi:type="Coalesce">
            <operand localId="388" locator="82:5-82:40" path="value" xsi:type="Property">
               <source localId="384" locator="82:5-82:34" strict="false" xsi:type="As">
                  <operand localId="386" locator="82:6-82:16" path="effective" xsi:type="Property">
                     <source localId="385" locator="82:6" name="o" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="387" locator="82:21-82:33" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </source>
            </operand>
            <operand localId="393" locator="83:5-83:39" path="value" xsi:type="Property">
               <source localId="389" locator="83:5-83:33" strict="false" xsi:type="As">
                  <operand localId="391" locator="83:6-83:16" path="effective" xsi:type="Property">
                     <source localId="390" locator="83:6" name="o" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="392" locator="83:21-83:32" name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
               </source>
            </operand>
            <operand localId="399" locator="84:5-84:44" path="value" xsi:type="Property">
               <source localId="398" locator="84:5-84:38" path="end" xsi:type="Property">
                  <source localId="394" locator="84:5-84:32" strict="false" xsi:type="As">
                     <operand localId="396" locator="84:6-84:16" path="effective" xsi:type="Property">
                        <source localId="395" locator="84:6" name="o" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="397" locator="84:21-84:31" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
            <operand localId="405" locator="85:5-85:46" path="value" xsi:type="Property">
               <source localId="404" locator="85:5-85:40" path="start" xsi:type="Property">
                  <source localId="400" locator="85:5-85:32" strict="false" xsi:type="As">
                     <operand localId="402" locator="85:6-85:16" path="effective" xsi:type="Property">
                        <source localId="401" locator="85:6" name="o" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="403" locator="85:21-85:31" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
            <operand localId="410" locator="86:5-86:36" path="value" xsi:type="Property">
               <source localId="406" locator="86:5-86:30" strict="false" xsi:type="As">
                  <operand localId="408" locator="86:6-86:13" path="issued" xsi:type="Property">
                     <source localId="407" locator="86:6" name="o" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="409" locator="86:18-86:29" name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
               </source>
            </operand>
         </expression>
         <operand localId="383" name="o">
            <operandTypeSpecifier localId="382" locator="80:35-80:50" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="414" locator="93:1-100:3" name="ObservationDateString" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="414">
               <a:s>// Returns a text representation of a date associated with an Observation, preferring `effectiveDateTime`, then
// `effectivePeriod.start`, then `issued`.
// @param o - a FHIR Observation to get the text date from
// @returns {System.String} the text representation of a relevant date from the Observation
define function ObservationDateString(o FHIR.Observation):
  </a:s>
               <a:s r="449">
                  <a:s r="449">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="421">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="417">
                           <a:s r="419">
                              <a:s r="418">
                                 <a:s>o</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="419">
                                 <a:s>effective</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="420">
                              <a:s>FHIR.dateTime</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="426">
                        <a:s>InstantText(</a:s>
                        <a:s r="422">
                           <a:s r="424">
                              <a:s r="423">
                                 <a:s>o</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="424">
                                 <a:s>effective</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="425">
                              <a:s>FHIR.instant</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="432">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="431">
                           <a:s r="427">
                              <a:s>(</a:s>
                              <a:s r="427">
                                 <a:s r="429">
                                    <a:s r="428">
                                       <a:s>o</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="429">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="430">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="431">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="438">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="437">
                           <a:s r="433">
                              <a:s>(</a:s>
                              <a:s r="433">
                                 <a:s r="435">
                                    <a:s r="434">
                                       <a:s>o</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="435">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="436">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="437">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="441">
                        <a:s>InstantText(</a:s>
                        <a:s r="440">
                           <a:s r="439">
                              <a:s>o</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="440">
                              <a:s>issued</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="449" locator="94:3-100:3" xsi:type="Coalesce">
            <signature localId="450" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="451" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="452" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="453" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="454" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <operand localId="421" locator="95:5-95:46" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="417" locator="95:18-95:45" strict="false" xsi:type="As">
                  <operand localId="419" locator="95:18-95:28" path="effective" xsi:type="Property">
                     <source localId="418" locator="95:18" name="o" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="420" locator="95:33-95:45" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
            <operand localId="426" locator="96:5-96:44" name="InstantText" xsi:type="FunctionRef">
               <operand localId="422" locator="96:17-96:43" strict="false" xsi:type="As">
                  <operand localId="424" locator="96:17-96:27" path="effective" xsi:type="Property">
                     <source localId="423" locator="96:17" name="o" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="425" locator="96:32-96:43" name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
            <operand localId="432" locator="97:5-97:52" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="431" locator="97:18-97:51" path="end" xsi:type="Property">
                  <source localId="427" locator="97:18-97:45" strict="false" xsi:type="As">
                     <operand localId="429" locator="97:19-97:29" path="effective" xsi:type="Property">
                        <source localId="428" locator="97:19" name="o" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="430" locator="97:34-97:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
            <operand localId="438" locator="98:5-98:54" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="437" locator="98:18-98:53" path="start" xsi:type="Property">
                  <source localId="433" locator="98:18-98:45" strict="false" xsi:type="As">
                     <operand localId="435" locator="98:19-98:29" path="effective" xsi:type="Property">
                        <source localId="434" locator="98:19" name="o" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="436" locator="98:34-98:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
            <operand localId="441" locator="99:5-99:25" name="InstantText" xsi:type="FunctionRef">
               <operand localId="440" locator="99:17-99:24" path="issued" xsi:type="Property">
                  <source localId="439" locator="99:17" name="o" xsi:type="OperandRef"/>
               </operand>
            </operand>
         </expression>
         <operand localId="416" name="o">
            <operandTypeSpecifier localId="415" locator="93:41-93:56" name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="455" locator="106:1-111:3" name="MedicationStatementDate" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="455">
               <a:s>// Returns a text representation of a date associated with a MedicationStatement, preferring `effectiveDateTime`, then
// `.start`.
// @param s - a FHIR MedicationStatement to get the text date from
// @returns {System.String} the text representation of a relevant date from the MedicationStatement
define function MedicationStatementDate(s FHIR.MedicationStatement):
  </a:s>
               <a:s r="477">
                  <a:s r="477">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="462">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="458">
                           <a:s r="460">
                              <a:s r="459">
                                 <a:s>s</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="460">
                                 <a:s>effective</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="461">
                              <a:s>FHIR.dateTime</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="468">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="467">
                           <a:s r="463">
                              <a:s>(</a:s>
                              <a:s r="463">
                                 <a:s r="465">
                                    <a:s r="464">
                                       <a:s>s</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="465">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="466">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="467">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="474">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="473">
                           <a:s r="469">
                              <a:s>(</a:s>
                              <a:s r="469">
                                 <a:s r="471">
                                    <a:s r="470">
                                       <a:s>s</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="471">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="472">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="473">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="477" locator="107:3-111:3" xsi:type="Coalesce">
            <operand localId="462" locator="108:5-108:46" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="458" locator="108:18-108:45" strict="false" xsi:type="As">
                  <operand localId="460" locator="108:18-108:28" path="effective" xsi:type="Property">
                     <source localId="459" locator="108:18" name="s" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="461" locator="108:33-108:45" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
            <operand localId="468" locator="109:5-109:52" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="467" locator="109:18-109:51" path="end" xsi:type="Property">
                  <source localId="463" locator="109:18-109:45" strict="false" xsi:type="As">
                     <operand localId="465" locator="109:19-109:29" path="effective" xsi:type="Property">
                        <source localId="464" locator="109:19" name="s" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="466" locator="109:34-109:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
            <operand localId="474" locator="110:5-110:54" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="473" locator="110:18-110:53" path="start" xsi:type="Property">
                  <source localId="469" locator="110:18-110:45" strict="false" xsi:type="As">
                     <operand localId="471" locator="110:19-110:29" path="effective" xsi:type="Property">
                        <source localId="470" locator="110:19" name="s" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="472" locator="110:34-110:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
         </expression>
         <operand localId="457" name="s">
            <operandTypeSpecifier localId="456" locator="106:43-106:66" name="fhir:MedicationStatement" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="478" locator="117:1-124:4" name="Onset" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="478">
               <a:s>// Returns a text representation of a Condition's onset, whether represented as a dateTime, Period, Quantity (Age),
// Range (Age), or string.
// @param c - a FHIR Condition to get the text representation of the onset from
// @returns {System.String} the text representation of the Condition's onset
define function Onset(c FHIR.Condition):
  </a:s>
               <a:s r="511">
                  <a:s r="511">
                     <a:s>Coalesce( </a:s>
                     <a:s r="481">
                        <a:s>List{
    </a:s>
                        <a:s r="486">
                           <a:s>DateTimeText(</a:s>
                           <a:s r="482">
                              <a:s r="484">
                                 <a:s r="483">
                                    <a:s>c</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="484">
                                    <a:s>onset</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="485">
                                 <a:s>FHIR.dateTime</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>,
    </a:s>
                        <a:s r="491">
                           <a:s>QuantityText(</a:s>
                           <a:s r="487">
                              <a:s r="489">
                                 <a:s r="488">
                                    <a:s>c</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="489">
                                    <a:s>onset</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="490">
                                 <a:s>FHIR.Age</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>,
    </a:s>
                        <a:s r="496">
                           <a:s>PeriodObject(</a:s>
                           <a:s r="492">
                              <a:s r="494">
                                 <a:s r="493">
                                    <a:s>c</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="494">
                                    <a:s>onset</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="495">
                                 <a:s>FHIR.Period</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>,
    </a:s>
                        <a:s r="501">
                           <a:s>RangeObject(</a:s>
                           <a:s r="497">
                              <a:s r="499">
                                 <a:s r="498">
                                    <a:s>c</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="499">
                                    <a:s>onset</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="500">
                                 <a:s>FHIR.Range</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>,
    </a:s>
                        <a:s r="506">
                           <a:s r="502">
                              <a:s>(</a:s>
                              <a:s r="502">
                                 <a:s r="504">
                                    <a:s r="503">
                                       <a:s>c</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="504">
                                       <a:s>onset</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="505">
                                    <a:s>FHIR.string</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="506">
                              <a:s>value</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  }</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="511" locator="118:3-124:4" xsi:type="Coalesce">
            <signature localId="512" xsi:type="ListTypeSpecifier">
               <elementType localId="513" name="t:Any" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="481" locator="118:13-124:3" xsi:type="List">
               <element localId="486" locator="119:5-119:42" name="DateTimeText" xsi:type="FunctionRef">
                  <operand localId="482" locator="119:18-119:41" strict="false" xsi:type="As">
                     <operand localId="484" locator="119:18-119:24" path="onset" xsi:type="Property">
                        <source localId="483" locator="119:18" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="485" locator="119:29-119:41" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </element>
               <element localId="491" locator="120:5-120:37" name="QuantityText" xsi:type="FunctionRef">
                  <operand localId="487" locator="120:18-120:36" strict="false" xsi:type="As">
                     <operand localId="489" locator="120:18-120:24" path="onset" xsi:type="Property">
                        <source localId="488" locator="120:18" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="490" locator="120:29-120:36" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </element>
               <element localId="496" locator="121:5-121:40" name="PeriodObject" xsi:type="FunctionRef">
                  <operand localId="492" locator="121:18-121:39" strict="false" xsi:type="As">
                     <operand localId="494" locator="121:18-121:24" path="onset" xsi:type="Property">
                        <source localId="493" locator="121:18" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="495" locator="121:29-121:39" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </element>
               <element localId="501" locator="122:5-122:38" name="RangeObject" xsi:type="FunctionRef">
                  <operand localId="497" locator="122:17-122:37" strict="false" xsi:type="As">
                     <operand localId="499" locator="122:17-122:23" path="onset" xsi:type="Property">
                        <source localId="498" locator="122:17" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="500" locator="122:28-122:37" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </element>
               <element localId="506" locator="123:5-123:34" path="value" xsi:type="Property">
                  <source localId="502" locator="123:5-123:28" strict="false" xsi:type="As">
                     <operand localId="504" locator="123:6-123:12" path="onset" xsi:type="Property">
                        <source localId="503" locator="123:6" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="505" locator="123:17-123:27" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </element>
            </operand>
         </expression>
         <operand localId="480" name="c">
            <operandTypeSpecifier localId="479" locator="117:25-117:38" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="514" locator="130:1-137:4" name="Abatement" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="514">
               <a:s>// Returns a text representation of a Condition's abatement, whether represented as a dateTime, Period, Quantity (Age),
// Range (Age), string, or boolean.
// @param c - a FHIR Condition to get the text representation of the abatement from
// @returns {System.String} the text representation of the Condition's abatement
define function Abatement(c FHIR.Condition):
  </a:s>
               <a:s r="542">
                  <a:s r="542">
                     <a:s>Coalesce( </a:s>
                     <a:s r="517">
                        <a:s>List{
    </a:s>
                        <a:s r="522">
                           <a:s>DateTimeText(</a:s>
                           <a:s r="518">
                              <a:s r="520">
                                 <a:s r="519">
                                    <a:s>c</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="520">
                                    <a:s>abatement</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="521">
                                 <a:s>FHIR.dateTime</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>,
    // QuantityText(c.abatement as FHIR.Age),
    </a:s>
                        <a:s r="527">
                           <a:s>PeriodObject(</a:s>
                           <a:s r="523">
                              <a:s r="525">
                                 <a:s r="524">
                                    <a:s>c</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="525">
                                    <a:s>abatement</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="526">
                                 <a:s>FHIR.Period</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>,
    </a:s>
                        <a:s r="532">
                           <a:s>RangeObject(</a:s>
                           <a:s r="528">
                              <a:s r="530">
                                 <a:s r="529">
                                    <a:s>c</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="530">
                                    <a:s>abatement</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="531">
                                 <a:s>FHIR.Range</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>,
    </a:s>
                        <a:s r="537">
                           <a:s r="533">
                              <a:s>(</a:s>
                              <a:s r="533">
                                 <a:s r="535">
                                    <a:s r="534">
                                       <a:s>c</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="535">
                                       <a:s>abatement</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="536">
                                    <a:s>FHIR.string</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="537">
                              <a:s>value</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  }</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="542" locator="131:3-137:4" xsi:type="Coalesce">
            <signature localId="543" xsi:type="ListTypeSpecifier">
               <elementType localId="544" name="t:Any" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="517" locator="131:13-137:3" xsi:type="List">
               <element localId="522" locator="132:5-132:46" name="DateTimeText" xsi:type="FunctionRef">
                  <operand localId="518" locator="132:18-132:45" strict="false" xsi:type="As">
                     <operand localId="520" locator="132:18-132:28" path="abatement" xsi:type="Property">
                        <source localId="519" locator="132:18" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="521" locator="132:33-132:45" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </element>
               <element localId="527" locator="134:5-134:44" name="PeriodObject" xsi:type="FunctionRef">
                  <operand localId="523" locator="134:18-134:43" strict="false" xsi:type="As">
                     <operand localId="525" locator="134:18-134:28" path="abatement" xsi:type="Property">
                        <source localId="524" locator="134:18" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="526" locator="134:33-134:43" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </element>
               <element localId="532" locator="135:5-135:42" name="RangeObject" xsi:type="FunctionRef">
                  <operand localId="528" locator="135:17-135:41" strict="false" xsi:type="As">
                     <operand localId="530" locator="135:17-135:27" path="abatement" xsi:type="Property">
                        <source localId="529" locator="135:17" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="531" locator="135:32-135:41" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </element>
               <element localId="537" locator="136:5-136:38" path="value" xsi:type="Property">
                  <source localId="533" locator="136:5-136:32" strict="false" xsi:type="As">
                     <operand localId="535" locator="136:6-136:16" path="abatement" xsi:type="Property">
                        <source localId="534" locator="136:6" name="c" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="536" locator="136:21-136:31" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </element>
            </operand>
         </expression>
         <operand localId="516" name="c">
            <operandTypeSpecifier localId="515" locator="130:29-130:42" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="545" locator="148:1-154:3" name="ConditionDate" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="545">
               <a:s>/*******************************************************************************
 * END: Code adapted from &quot;Factors to Consider in Managing Chronic Pain: A Pain 
 * Management Summary&quot;
*******************************************************************************/

/*******************************************************************************
* Condition Functions
*******************************************************************************/

define function ConditionDate(C Condition):
  </a:s>
               <a:s r="570">
                  <a:s r="570">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="552">
                        <a:s r="548">
                           <a:s>(</a:s>
                           <a:s r="548">
                              <a:s r="550">
                                 <a:s r="549">
                                    <a:s>C</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="550">
                                    <a:s>onset</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="551">
                                 <a:s>FHIR.dateTime</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="552">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="558">
                        <a:s r="557">
                           <a:s r="553">
                              <a:s>(</a:s>
                              <a:s r="553">
                                 <a:s r="555">
                                    <a:s r="554">
                                       <a:s>C</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="555">
                                       <a:s>onset</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="556">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="557">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="558">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="564">
                        <a:s r="563">
                           <a:s r="559">
                              <a:s>(</a:s>
                              <a:s r="559">
                                 <a:s r="561">
                                    <a:s r="560">
                                       <a:s>C</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="561">
                                       <a:s>onset</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="562">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="563">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="564">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="567">
                        <a:s r="566">
                           <a:s r="565">
                              <a:s>C</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="566">
                              <a:s>recordedDate</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="567">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="570" locator="149:3-154:3" xsi:type="Coalesce">
            <operand localId="552" locator="150:5-150:36" path="value" xsi:type="Property">
               <source localId="548" locator="150:5-150:30" strict="false" xsi:type="As">
                  <operand localId="550" locator="150:6-150:12" path="onset" xsi:type="Property">
                     <source localId="549" locator="150:6" name="C" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="551" locator="150:17-150:29" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </source>
            </operand>
            <operand localId="558" locator="151:5-151:40" path="value" xsi:type="Property">
               <source localId="557" locator="151:5-151:34" path="end" xsi:type="Property">
                  <source localId="553" locator="151:5-151:28" strict="false" xsi:type="As">
                     <operand localId="555" locator="151:6-151:12" path="onset" xsi:type="Property">
                        <source localId="554" locator="151:6" name="C" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="556" locator="151:17-151:27" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
            <operand localId="564" locator="152:5-152:42" path="value" xsi:type="Property">
               <source localId="563" locator="152:5-152:36" path="start" xsi:type="Property">
                  <source localId="559" locator="152:5-152:28" strict="false" xsi:type="As">
                     <operand localId="561" locator="152:6-152:12" path="onset" xsi:type="Property">
                        <source localId="560" locator="152:6" name="C" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="562" locator="152:17-152:27" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
            <operand localId="567" locator="153:5-153:24" path="value" xsi:type="Property">
               <source localId="566" locator="153:5-153:18" path="recordedDate" xsi:type="Property">
                  <source localId="565" locator="153:5" name="C" xsi:type="OperandRef"/>
               </source>
            </operand>
         </expression>
         <operand localId="547" name="C">
            <operandTypeSpecifier localId="546" locator="148:33-148:41" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="571" locator="163:1-169:3" name="OldestCondition" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="571">
               <a:s>/**
 * The oldest condition.  For each Condition, this algorithm will use the Coalesce function, which uses the
 * first non-null result from these fields: onsetDateTime, onsetPeriod.start, assertedDate, onsetPeriod.end.
 * The found date will be used to compare Conditions and determine the oldest one.
 * @param CondList - a list of Conditions
 * @returns {Condition} the oldest Condition from the list, or null if null was passed in
 */
define function OldestCondition(CondList List&lt;Condition>):
  </a:s>
               <a:s r="627">
                  <a:s r="627">
                     <a:s>First(</a:s>
                     <a:s r="622">
                        <a:s>
                           <a:s r="575">
                              <a:s r="576">
                                 <a:s>
                                    <a:s>CondList</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> C</a:s>
                           </a:s>
                        </a:s>
                        <a:s> </a:s>
                        <a:s r="616">
                           <a:s>sort by </a:s>
                           <a:s r="615">
                              <a:s r="614">
                                 <a:s>Coalesce(
    </a:s>
                                 <a:s r="599">
                                    <a:s r="596">
                                       <a:s>(</a:s>
                                       <a:s r="596">
                                          <a:s r="597">
                                             <a:s>onset</a:s>
                                          </a:s>
                                          <a:s> as </a:s>
                                          <a:s r="598">
                                             <a:s>FHIR.dateTime</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="599">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>,
    </a:s>
                                 <a:s r="604">
                                    <a:s r="603">
                                       <a:s r="600">
                                          <a:s>(</a:s>
                                          <a:s r="600">
                                             <a:s r="601">
                                                <a:s>onset</a:s>
                                             </a:s>
                                             <a:s> as </a:s>
                                             <a:s r="602">
                                                <a:s>FHIR.Period</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="603">
                                          <a:s>&quot;start&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="604">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>,
    </a:s>
                                 <a:s r="606">
                                    <a:s r="605">
                                       <a:s>recordedDate</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="606">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>,
    </a:s>
                                 <a:s r="611">
                                    <a:s r="610">
                                       <a:s r="607">
                                          <a:s>(</a:s>
                                          <a:s r="607">
                                             <a:s r="608">
                                                <a:s>onset</a:s>
                                             </a:s>
                                             <a:s> as </a:s>
                                             <a:s r="609">
                                                <a:s>FHIR.Period</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="610">
                                          <a:s>&quot;end&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="611">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="627" locator="164:3-169:3" xsi:type="First">
            <signature localId="628" xsi:type="ListTypeSpecifier">
               <elementType localId="629" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <source localId="622" locator="164:9-168:39" xsi:type="Query">
               <source localId="575" locator="164:9-164:18" alias="C">
                  <expression localId="576" locator="164:9-164:16" name="CondList" xsi:type="OperandRef"/>
               </source>
               <sort localId="616" locator="164:20-168:39">
                  <by localId="615" locator="164:28-168:39" direction="asc" xsi:type="ByExpression">
                     <expression localId="614" locator="164:28-168:39" xsi:type="Coalesce">
                        <operand localId="599" locator="165:5-165:34" path="value" xsi:type="Property">
                           <source localId="596" locator="165:5-165:28" strict="false" xsi:type="As">
                              <operand localId="597" locator="165:6-165:10" name="onset" xsi:type="IdentifierRef"/>
                              <asTypeSpecifier localId="598" locator="165:15-165:27" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           </source>
                        </operand>
                        <operand localId="604" locator="166:5-166:40" path="value" xsi:type="Property">
                           <source localId="603" locator="166:5-166:34" path="start" xsi:type="Property">
                              <source localId="600" locator="166:5-166:26" strict="false" xsi:type="As">
                                 <operand localId="601" locator="166:6-166:10" name="onset" xsi:type="IdentifierRef"/>
                                 <asTypeSpecifier localId="602" locator="166:15-166:25" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              </source>
                           </source>
                        </operand>
                        <operand localId="606" locator="167:5-167:22" path="value" xsi:type="Property">
                           <source localId="605" locator="167:5-167:16" name="recordedDate" xsi:type="IdentifierRef"/>
                        </operand>
                        <operand localId="611" locator="168:5-168:38" path="value" xsi:type="Property">
                           <source localId="610" locator="168:5-168:32" path="end" xsi:type="Property">
                              <source localId="607" locator="168:5-168:26" strict="false" xsi:type="As">
                                 <operand localId="608" locator="168:6-168:10" name="onset" xsi:type="IdentifierRef"/>
                                 <asTypeSpecifier localId="609" locator="168:15-168:25" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              </source>
                           </source>
                        </operand>
                     </expression>
                  </by>
               </sort>
            </source>
         </expression>
         <operand localId="574" name="CondList">
            <operandTypeSpecifier localId="572" locator="163:42-163:56" xsi:type="ListTypeSpecifier">
               <elementType localId="573" locator="163:47-163:55" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="630" locator="179:1-184:3" name="DateOfFirstCondition" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="630">
               <a:s>/**
 * Date of the oldest condition in a list.  For each Condition, this algorithm will use the Coalesce function, which uses the
 * first non-null result from these fields: onsetDateTime, onsetPeriod.start, assertedDate, onsetPeriod.end.
 * The found date will be used to compare Conditions and determine the oldest one. The date of the oldest Condition
 * will be returned.
 * @param CondList - a list of Conditions
 * @returns {System.String} the text representation of the Condition's date
 */
define function DateOfFirstCondition(CondList List&lt;Condition>):
  </a:s>
               <a:s r="636">
                  <a:s r="636">
                     <a:s>ConditionDate(
    </a:s>
                     <a:s r="635">
                        <a:s>OldestCondition(
      </a:s>
                        <a:s r="634">
                           <a:s>CondList</a:s>
                        </a:s>
                        <a:s>
    )</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="636" locator="180:3-184:3" name="ConditionDate" xsi:type="FunctionRef">
            <operand localId="635" locator="181:5-183:5" name="OldestCondition" xsi:type="FunctionRef">
               <operand localId="634" locator="182:7-182:14" name="CondList" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand localId="633" name="CondList">
            <operandTypeSpecifier localId="631" locator="179:47-179:61" xsi:type="ListTypeSpecifier">
               <elementType localId="632" locator="179:52-179:60" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="637" locator="192:1-194:60" name="ValidCondition" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="637">
               <a:s>/**
 * Conditions that are valid. This is reflected by a Condition that does not have a verificationStatus of 'refuted' or `entered-in-error`.
 * @see http://hl7.org/fhir/R4/valueset-condition-ver-status.html
 * @param CondList - a list of Conditions
 * @returns {List&lt;Condition>} a list of valid Conditions, or null if null was passed in
 */
define function ValidCondition(CondList List&lt;Condition>):
  </a:s>
               <a:s r="660">
                  <a:s r="660">
                     <a:s>
                        <a:s r="641">
                           <a:s r="642">
                              <a:s>
                                 <a:s>CondList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> C</a:s>
                        </a:s>
                     </a:s>
                     <a:s> </a:s>
                     <a:s r="643">
                        <a:s>where </a:s>
                        <a:s r="643">
                           <a:s r="651">
                              <a:s r="646">
                                 <a:s r="645">
                                    <a:s>C</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="646">
                                    <a:s>verificationStatus</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> !~ </a:s>
                              <a:s r="647">
                                 <a:s>&quot;Condition Refuted&quot;</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
    and </a:s>
                           <a:s r="659">
                              <a:s r="654">
                                 <a:s r="653">
                                    <a:s>C</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="654">
                                    <a:s>verificationStatus</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> !~ </a:s>
                              <a:s r="655">
                                 <a:s>&quot;Condition Entered in Error&quot;</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="660" locator="193:3-194:60" xsi:type="Query">
            <source localId="641" locator="193:3-193:12" alias="C">
               <expression localId="642" locator="193:3-193:10" name="CondList" xsi:type="OperandRef"/>
            </source>
            <where localId="643" locator="193:14-194:60" xsi:type="And">
               <operand localId="651" locator="193:20-193:62" xsi:type="Not">
                  <operand localId="644" locator="193:20-193:62" xsi:type="Equivalent">
                     <signature localId="649" name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="650" name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="648" name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <operand localId="646" locator="193:20-193:39" path="verificationStatus" scope="C" xsi:type="Property"/>
                     </operand>
                     <operand localId="647" locator="193:44-193:62" name="Condition Refuted" xsi:type="ConceptRef"/>
                  </operand>
               </operand>
               <operand localId="659" locator="194:9-194:60" xsi:type="Not">
                  <operand localId="652" locator="194:9-194:60" xsi:type="Equivalent">
                     <signature localId="657" name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="658" name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="656" name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <operand localId="654" locator="194:9-194:28" path="verificationStatus" scope="C" xsi:type="Property"/>
                     </operand>
                     <operand localId="655" locator="194:33-194:60" name="Condition Entered in Error" xsi:type="ConceptRef"/>
                  </operand>
               </operand>
            </where>
         </expression>
         <operand localId="640" name="CondList">
            <operandTypeSpecifier localId="638" locator="192:41-192:55" xsi:type="ListTypeSpecifier">
               <elementType localId="639" locator="192:46-192:54" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="661" locator="204:1-209:3" name="DiagnosticReportDateString" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="661">
               <a:s>/*******************************************************************************
* DiagnosticReport Functions
*******************************************************************************/

// Returns a text representation of a date associated with a DiagnosticReport, preferring `effectiveDateTime`, then
// `.start`.
// @param s - a FHIR DiagnosticReport to get the text date from
// @returns {System.String} the text representation of a relevant date from the DiagnosticReport
define function DiagnosticReportDateString(d FHIR.DiagnosticReport):
  </a:s>
               <a:s r="687">
                  <a:s r="687">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="671">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="664">
                           <a:s r="669">
                              <a:s r="665">
                                 <a:s>(</a:s>
                                 <a:s r="665">
                                    <a:s r="667">
                                       <a:s r="666">
                                          <a:s>d</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="667">
                                          <a:s>effective</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> as </a:s>
                                    <a:s r="668">
                                       <a:s>FHIR.Period</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="669">
                                 <a:s>&quot;end&quot;</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="670">
                              <a:s>FHIR.dateTime</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="676">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="672">
                           <a:s r="674">
                              <a:s r="673">
                                 <a:s>d</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="674">
                                 <a:s>effective</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="675">
                              <a:s>FHIR.dateTime</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="684">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="677">
                           <a:s r="682">
                              <a:s r="678">
                                 <a:s>(</a:s>
                                 <a:s r="678">
                                    <a:s r="680">
                                       <a:s r="679">
                                          <a:s>d</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="680">
                                          <a:s>effective</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> as </a:s>
                                    <a:s r="681">
                                       <a:s>FHIR.Period</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="682">
                                 <a:s>&quot;start&quot;</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="683">
                              <a:s>FHIR.dateTime</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="687" locator="205:3-209:3" xsi:type="Coalesce">
            <operand localId="671" locator="206:5-206:69" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="664" locator="206:18-206:68" strict="false" xsi:type="As">
                  <operand localId="669" locator="206:18-206:51" path="end" xsi:type="Property">
                     <source localId="665" locator="206:18-206:45" strict="false" xsi:type="As">
                        <operand localId="667" locator="206:19-206:29" path="effective" xsi:type="Property">
                           <source localId="666" locator="206:19" name="d" xsi:type="OperandRef"/>
                        </operand>
                        <asTypeSpecifier localId="668" locator="206:34-206:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     </source>
                  </operand>
                  <asTypeSpecifier localId="670" locator="206:56-206:68" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
            <operand localId="676" locator="207:5-207:46" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="672" locator="207:18-207:45" strict="false" xsi:type="As">
                  <operand localId="674" locator="207:18-207:28" path="effective" xsi:type="Property">
                     <source localId="673" locator="207:18" name="d" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="675" locator="207:33-207:45" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
            <operand localId="684" locator="208:5-208:71" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="677" locator="208:18-208:70" strict="false" xsi:type="As">
                  <operand localId="682" locator="208:18-208:53" path="start" xsi:type="Property">
                     <source localId="678" locator="208:18-208:45" strict="false" xsi:type="As">
                        <operand localId="680" locator="208:19-208:29" path="effective" xsi:type="Property">
                           <source localId="679" locator="208:19" name="d" xsi:type="OperandRef"/>
                        </operand>
                        <asTypeSpecifier localId="681" locator="208:34-208:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     </source>
                  </operand>
                  <asTypeSpecifier localId="683" locator="208:58-208:70" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
         </expression>
         <operand localId="663" name="d">
            <operandTypeSpecifier localId="662" locator="204:46-204:66" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="688" locator="211:1-216:3" name="DiagnosticReportDate" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="688">
               <a:s>define function DiagnosticReportDate(d FHIR.DiagnosticReport):
  </a:s>
               <a:s r="713">
                  <a:s r="713">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="696">
                        <a:s r="695">
                           <a:s r="691">
                              <a:s>(</a:s>
                              <a:s r="691">
                                 <a:s r="693">
                                    <a:s r="692">
                                       <a:s>d</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="693">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="694">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="695">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="696">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="701">
                        <a:s r="697">
                           <a:s>(</a:s>
                           <a:s r="697">
                              <a:s r="699">
                                 <a:s r="698">
                                    <a:s>d</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="699">
                                    <a:s>effective</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="700">
                                 <a:s>FHIR.dateTime</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="701">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="707">
                        <a:s r="706">
                           <a:s r="702">
                              <a:s>(</a:s>
                              <a:s r="702">
                                 <a:s r="704">
                                    <a:s r="703">
                                       <a:s>d</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="704">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="705">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="706">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="707">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="713" locator="212:3-216:3" xsi:type="Coalesce">
            <signature localId="714" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <signature localId="715" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <signature localId="716" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <operand localId="696" locator="213:5-213:44" path="value" xsi:type="Property">
               <source localId="695" locator="213:5-213:38" path="end" xsi:type="Property">
                  <source localId="691" locator="213:5-213:32" strict="false" xsi:type="As">
                     <operand localId="693" locator="213:6-213:16" path="effective" xsi:type="Property">
                        <source localId="692" locator="213:6" name="d" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="694" locator="213:21-213:31" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
            <operand localId="701" locator="214:5-214:40" path="value" xsi:type="Property">
               <source localId="697" locator="214:5-214:34" strict="false" xsi:type="As">
                  <operand localId="699" locator="214:6-214:16" path="effective" xsi:type="Property">
                     <source localId="698" locator="214:6" name="d" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="700" locator="214:21-214:33" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </source>
            </operand>
            <operand localId="707" locator="215:5-215:46" path="value" xsi:type="Property">
               <source localId="706" locator="215:5-215:40" path="start" xsi:type="Property">
                  <source localId="702" locator="215:5-215:32" strict="false" xsi:type="As">
                     <operand localId="704" locator="215:6-215:16" path="effective" xsi:type="Property">
                        <source localId="703" locator="215:6" name="d" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="705" locator="215:21-215:31" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
         </expression>
         <operand localId="690" name="d">
            <operandTypeSpecifier localId="689" locator="211:40-211:60" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="717" locator="218:1-223:3" name="SortedDiagnosticReports" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="717">
               <a:s>define function SortedDiagnosticReports(ReportList List&lt;FHIR.DiagnosticReport>):
  </a:s>
               <a:s r="770">
                  <a:s r="770">
                     <a:s>
                        <a:s r="721">
                           <a:s r="722">
                              <a:s>
                                 <a:s>ReportList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> R</a:s>
                        </a:s>
                     </a:s>
                     <a:s> </a:s>
                     <a:s r="764">
                        <a:s>sort by </a:s>
                        <a:s r="763">
                           <a:s r="759">
                              <a:s>Coalesce(
    </a:s>
                              <a:s r="744">
                                 <a:s r="743">
                                    <a:s r="740">
                                       <a:s>(</a:s>
                                       <a:s r="740">
                                          <a:s r="741">
                                             <a:s>effective</a:s>
                                          </a:s>
                                          <a:s> as </a:s>
                                          <a:s r="742">
                                             <a:s>FHIR.Period</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="743">
                                       <a:s>&quot;end&quot;</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="744">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>,
    </a:s>
                              <a:s r="748">
                                 <a:s r="745">
                                    <a:s>(</a:s>
                                    <a:s r="745">
                                       <a:s r="746">
                                          <a:s>effective</a:s>
                                       </a:s>
                                       <a:s> as </a:s>
                                       <a:s r="747">
                                          <a:s>FHIR.dateTime</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="748">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>,
    </a:s>
                              <a:s r="753">
                                 <a:s r="752">
                                    <a:s r="749">
                                       <a:s>(</a:s>
                                       <a:s r="749">
                                          <a:s r="750">
                                             <a:s>effective</a:s>
                                          </a:s>
                                          <a:s> as </a:s>
                                          <a:s r="751">
                                             <a:s>FHIR.Period</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="752">
                                       <a:s>&quot;start&quot;</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="753">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  )</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="770" locator="219:3-223:3" xsi:type="Query">
            <source localId="721" locator="219:3-219:14" alias="R">
               <expression localId="722" locator="219:3-219:12" name="ReportList" xsi:type="OperandRef"/>
            </source>
            <sort localId="764" locator="219:16-223:3">
               <by localId="763" locator="219:24-223:3" direction="asc" xsi:type="ByExpression">
                  <expression localId="759" locator="219:24-223:3" xsi:type="Coalesce">
                     <signature localId="760" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="761" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="762" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="744" locator="220:5-220:42" path="value" xsi:type="Property">
                        <source localId="743" locator="220:5-220:36" path="end" xsi:type="Property">
                           <source localId="740" locator="220:5-220:30" strict="false" xsi:type="As">
                              <operand localId="741" locator="220:6-220:14" name="effective" xsi:type="IdentifierRef"/>
                              <asTypeSpecifier localId="742" locator="220:19-220:29" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           </source>
                        </source>
                     </operand>
                     <operand localId="748" locator="221:5-221:38" path="value" xsi:type="Property">
                        <source localId="745" locator="221:5-221:32" strict="false" xsi:type="As">
                           <operand localId="746" locator="221:6-221:14" name="effective" xsi:type="IdentifierRef"/>
                           <asTypeSpecifier localId="747" locator="221:19-221:31" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        </source>
                     </operand>
                     <operand localId="753" locator="222:5-222:44" path="value" xsi:type="Property">
                        <source localId="752" locator="222:5-222:38" path="start" xsi:type="Property">
                           <source localId="749" locator="222:5-222:30" strict="false" xsi:type="As">
                              <operand localId="750" locator="222:6-222:14" name="effective" xsi:type="IdentifierRef"/>
                              <asTypeSpecifier localId="751" locator="222:19-222:29" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           </source>
                        </source>
                     </operand>
                  </expression>
               </by>
            </sort>
         </expression>
         <operand localId="720" name="ReportList">
            <operandTypeSpecifier localId="718" locator="218:52-218:78" xsi:type="ListTypeSpecifier">
               <elementType localId="719" locator="218:57-218:77" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="771" locator="225:1-230:3" name="MostRecentDiagnosticReport" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="771">
               <a:s>define function MostRecentDiagnosticReport(ReportList List&lt;FHIR.DiagnosticReport>):
  </a:s>
               <a:s r="779">
                  <a:s r="779">
                     <a:s>Last(
    </a:s>
                     <a:s r="776">
                        <a:s>SortedDiagnosticReports(
      </a:s>
                        <a:s r="775">
                           <a:s>ReportList</a:s>
                        </a:s>
                        <a:s>
    )</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="779" locator="226:3-230:3" xsi:type="Last">
            <source localId="776" locator="227:5-229:5" name="SortedDiagnosticReports" xsi:type="FunctionRef">
               <operand localId="775" locator="228:7-228:16" name="ReportList" xsi:type="OperandRef"/>
            </source>
         </expression>
         <operand localId="774" name="ReportList">
            <operandTypeSpecifier localId="772" locator="225:55-225:81" xsi:type="ListTypeSpecifier">
               <elementType localId="773" locator="225:60-225:80" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="780" locator="240:1-244:83" name="LookBack" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="780">
               <a:s>/**
* Diagnostic Reports that are issued in the specified &quot;look back&quot; period.
* TODO: Rename to LookBack once the execution engine supports overloaded functions.
* @param DiagnosticReportList - a list of DiagnosticReports
* @param LookBack - the lookback period for when the DiagnosticReport specimen was collected
* @returns {List&lt;DiagnosticReport>} a list of DiagnosticReports in the look back period, or null if null
* was passed in
*/
define function LookBack(DiagnosticReportList List&lt;DiagnosticReport>, LookBack System.Quantity):
  </a:s>
               <a:s r="816">
                  <a:s r="816">
                     <a:s>
                        <a:s r="786">
                           <a:s r="787">
                              <a:s>
                                 <a:s>DiagnosticReportList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> D</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s>
                        <a:s>let </a:s>
                        <a:s r="788">
                           <a:s>LookBackInterval: </a:s>
                           <a:s r="799">
                              <a:s>Interval[</a:s>
                              <a:s r="789">
                                 <a:s r="792">
                                    <a:s>Now()</a:s>
                                 </a:s>
                                 <a:s> - </a:s>
                                 <a:s r="793">
                                    <a:s>LookBack</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="798">
                                 <a:s>Now()</a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="800">
                        <a:s>where </a:s>
                        <a:s r="800">
                           <a:s r="807">
                              <a:s r="805">
                                 <a:s r="801">
                                    <a:s>(</a:s>
                                    <a:s r="801">
                                       <a:s r="803">
                                          <a:s r="802">
                                             <a:s>D</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="803">
                                             <a:s>effective</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> as </a:s>
                                       <a:s r="804">
                                          <a:s>FHIR.dateTime</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="805">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> in </a:s>
                              <a:s r="806">
                                 <a:s>LookBackInterval</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      or </a:s>
                           <a:s r="815">
                              <a:s r="813">
                                 <a:s r="808">
                                    <a:s>C3F</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="813">
                                    <a:s>PeriodToInterval(</a:s>
                                    <a:s r="809">
                                       <a:s r="811">
                                          <a:s r="810">
                                             <a:s>D</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="811">
                                             <a:s>effective</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> as </a:s>
                                       <a:s r="812">
                                          <a:s>FHIR.Period</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s r="815"> overlaps </a:s>
                              <a:s r="814">
                                 <a:s>LookBackInterval</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="816" locator="241:3-244:83" xsi:type="Query">
            <source localId="786" locator="241:3-241:24" alias="D">
               <expression localId="787" locator="241:3-241:22" name="DiagnosticReportList" xsi:type="OperandRef"/>
            </source>
            <let localId="788" locator="242:9-242:59" identifier="LookBackInterval">
               <expression localId="799" locator="242:27-242:59" lowClosed="true" highClosed="true" xsi:type="Interval">
                  <low localId="789" locator="242:36-242:51" xsi:type="Subtract">
                     <signature localId="794" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="795" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="792" locator="242:36-242:40" xsi:type="Now"/>
                     <operand localId="793" locator="242:44-242:51" name="LookBack" xsi:type="OperandRef"/>
                  </low>
                  <high localId="798" locator="242:54-242:58" xsi:type="Now"/>
               </expression>
            </let>
            <where localId="800" locator="243:5-244:83" xsi:type="Or">
               <operand localId="807" locator="243:11-243:66" xsi:type="In">
                  <operand localId="805" locator="243:11-243:46" path="value" xsi:type="Property">
                     <source localId="801" locator="243:11-243:40" strict="false" xsi:type="As">
                        <operand localId="803" locator="243:12-243:22" path="effective" scope="D" xsi:type="Property"/>
                        <asTypeSpecifier localId="804" locator="243:27-243:39" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     </source>
                  </operand>
                  <operand localId="806" locator="243:51-243:66" name="LookBackInterval" xsi:type="QueryLetRef"/>
               </operand>
               <operand localId="815" locator="244:10-244:83" xsi:type="Overlaps">
                  <operand localId="813" locator="244:10-244:57" name="PeriodToInterval" libraryName="C3F" xsi:type="FunctionRef">
                     <operand localId="809" locator="244:31-244:56" strict="false" xsi:type="As">
                        <operand localId="811" locator="244:31-244:41" path="effective" scope="D" xsi:type="Property"/>
                        <asTypeSpecifier localId="812" locator="244:46-244:56" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     </operand>
                  </operand>
                  <operand localId="814" locator="244:68-244:83" name="LookBackInterval" xsi:type="QueryLetRef"/>
               </operand>
            </where>
         </expression>
         <operand localId="783" name="DiagnosticReportList">
            <operandTypeSpecifier localId="781" locator="240:47-240:68" xsi:type="ListTypeSpecifier">
               <elementType localId="782" locator="240:52-240:67" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
         <operand localId="785" name="LookBack">
            <operandTypeSpecifier localId="784" locator="240:80-240:94" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="817" locator="254:1-258:170" name="LookBack" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="817">
               <a:s>/**
* Diagnostic Reports that are issued in the specified &quot;look back&quot; period and after a specified &quot;look back&quot; date
* @param DiagnosticReportList - a list of DiagnosticReports
* @param LookBack - the lookback period for when the DiagnosticReport specimen was collected
* @param LookBackDate - the date that the DiagnosticReport test must fall after
* @returns {List&lt;DiagnosticReport>} a list of DiagnosticReports in the look back period and after the
* look back date, or null if null was passed in
*/
define function LookBack(DiagnosticReportList List&lt;DiagnosticReport>, LookBack System.Quantity, LookBackDate System.DateTime):
  </a:s>
               <a:s r="877">
                  <a:s r="877">
                     <a:s>
                        <a:s r="825">
                           <a:s r="826">
                              <a:s>
                                 <a:s>DiagnosticReportList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> D</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s>
                        <a:s>let </a:s>
                        <a:s r="827">
                           <a:s>LookBackInterval: </a:s>
                           <a:s r="838">
                              <a:s>Interval[</a:s>
                              <a:s r="828">
                                 <a:s r="831">
                                    <a:s>Now()</a:s>
                                 </a:s>
                                 <a:s> - </a:s>
                                 <a:s r="832">
                                    <a:s>LookBack</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="837">
                                 <a:s>Now()</a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="839">
                        <a:s>where </a:s>
                        <a:s r="839">
                           <a:s r="840">
                              <a:s>( </a:s>
                              <a:s r="840">
                                 <a:s r="847">
                                    <a:s>(</a:s>
                                    <a:s r="847">
                                       <a:s r="845">
                                          <a:s r="841">
                                             <a:s>(</a:s>
                                             <a:s r="841">
                                                <a:s r="843">
                                                   <a:s r="842">
                                                      <a:s>D</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="843">
                                                      <a:s>effective</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> as </a:s>
                                                <a:s r="844">
                                                   <a:s>FHIR.dateTime</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="845">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> in </a:s>
                                       <a:s r="846">
                                          <a:s>LookBackInterval</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s> and </a:s>
                                 <a:s r="854">
                                    <a:s>(</a:s>
                                    <a:s r="854">
                                       <a:s r="852">
                                          <a:s r="848">
                                             <a:s>(</a:s>
                                             <a:s r="848">
                                                <a:s r="850">
                                                   <a:s r="849">
                                                      <a:s>D</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="850">
                                                      <a:s>effective</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> as </a:s>
                                                <a:s r="851">
                                                   <a:s>FHIR.dateTime</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="852">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s r="854"> after </a:s>
                                       <a:s r="853">
                                          <a:s>LookBackDate</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> )</a:s>
                           </a:s>
                           <a:s>
      or </a:s>
                           <a:s r="857">
                              <a:s>( </a:s>
                              <a:s r="857">
                                 <a:s r="865">
                                    <a:s>(</a:s>
                                    <a:s r="865">
                                       <a:s r="863">
                                          <a:s r="858">
                                             <a:s>C3F</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="863">
                                             <a:s>PeriodToInterval(</a:s>
                                             <a:s r="859">
                                                <a:s r="861">
                                                   <a:s r="860">
                                                      <a:s>D</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="861">
                                                      <a:s>effective</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> as </a:s>
                                                <a:s r="862">
                                                   <a:s>FHIR.Period</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s r="865"> overlaps </a:s>
                                       <a:s r="864">
                                          <a:s>LookBackInterval</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s> and </a:s>
                                 <a:s r="874">
                                    <a:s>(</a:s>
                                    <a:s r="874">
                                       <a:s r="871">
                                          <a:s r="866">
                                             <a:s>C3F</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="871">
                                             <a:s>PeriodToInterval(</a:s>
                                             <a:s r="867">
                                                <a:s r="869">
                                                   <a:s r="868">
                                                      <a:s>D</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="869">
                                                      <a:s>effective</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> as </a:s>
                                                <a:s r="870">
                                                   <a:s>FHIR.Period</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s r="874"> starts after </a:s>
                                       <a:s r="872">
                                          <a:s>LookBackDate</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> )</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="877" locator="255:3-258:170" xsi:type="Query">
            <source localId="825" locator="255:3-255:24" alias="D">
               <expression localId="826" locator="255:3-255:22" name="DiagnosticReportList" xsi:type="OperandRef"/>
            </source>
            <let localId="827" locator="256:9-256:59" identifier="LookBackInterval">
               <expression localId="838" locator="256:27-256:59" lowClosed="true" highClosed="true" xsi:type="Interval">
                  <low localId="828" locator="256:36-256:51" xsi:type="Subtract">
                     <signature localId="833" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="834" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="831" locator="256:36-256:40" xsi:type="Now"/>
                     <operand localId="832" locator="256:44-256:51" name="LookBack" xsi:type="OperandRef"/>
                  </low>
                  <high localId="837" locator="256:54-256:58" xsi:type="Now"/>
               </expression>
            </let>
            <where localId="839" locator="257:5-258:170" xsi:type="Or">
               <operand localId="840" locator="257:11-257:134" xsi:type="And">
                  <operand localId="847" locator="257:13-257:70" xsi:type="In">
                     <operand localId="845" locator="257:14-257:49" path="value" xsi:type="Property">
                        <source localId="841" locator="257:14-257:43" strict="false" xsi:type="As">
                           <operand localId="843" locator="257:15-257:25" path="effective" scope="D" xsi:type="Property"/>
                           <asTypeSpecifier localId="844" locator="257:30-257:42" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        </source>
                     </operand>
                     <operand localId="846" locator="257:54-257:69" name="LookBackInterval" xsi:type="QueryLetRef"/>
                  </operand>
                  <operand localId="854" locator="257:76-257:132" xsi:type="After">
                     <signature localId="855" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="856" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="852" locator="257:77-257:112" path="value" xsi:type="Property">
                        <source localId="848" locator="257:77-257:106" strict="false" xsi:type="As">
                           <operand localId="850" locator="257:78-257:88" path="effective" scope="D" xsi:type="Property"/>
                           <asTypeSpecifier localId="851" locator="257:93-257:105" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        </source>
                     </operand>
                     <operand localId="853" locator="257:120-257:131" name="LookBackDate" xsi:type="OperandRef"/>
                  </operand>
               </operand>
               <operand localId="857" locator="258:10-258:170" xsi:type="And">
                  <operand localId="865" locator="258:12-258:87" xsi:type="Overlaps">
                     <operand localId="863" locator="258:13-258:60" name="PeriodToInterval" libraryName="C3F" xsi:type="FunctionRef">
                        <operand localId="859" locator="258:34-258:59" strict="false" xsi:type="As">
                           <operand localId="861" locator="258:34-258:44" path="effective" scope="D" xsi:type="Property"/>
                           <asTypeSpecifier localId="862" locator="258:49-258:59" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        </operand>
                     </operand>
                     <operand localId="864" locator="258:71-258:86" name="LookBackInterval" xsi:type="QueryLetRef"/>
                  </operand>
                  <operand localId="874" locator="258:93-258:168" xsi:type="After">
                     <signature localId="875" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="876" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="873" locator="258:143-258:148" xsi:type="Start">
                        <operand localId="871" locator="258:94-258:141" name="PeriodToInterval" libraryName="C3F" xsi:type="FunctionRef">
                           <operand localId="867" locator="258:115-258:140" strict="false" xsi:type="As">
                              <operand localId="869" locator="258:115-258:125" path="effective" scope="D" xsi:type="Property"/>
                              <asTypeSpecifier localId="870" locator="258:130-258:140" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           </operand>
                        </operand>
                     </operand>
                     <operand localId="872" locator="258:156-258:167" name="LookBackDate" xsi:type="OperandRef"/>
                  </operand>
               </operand>
            </where>
         </expression>
         <operand localId="820" name="DiagnosticReportList">
            <operandTypeSpecifier localId="818" locator="254:47-254:68" xsi:type="ListTypeSpecifier">
               <elementType localId="819" locator="254:52-254:67" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
         <operand localId="822" name="LookBack">
            <operandTypeSpecifier localId="821" locator="254:80-254:94" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand localId="824" name="LookBackDate">
            <operandTypeSpecifier localId="823" locator="254:110-254:124" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="878" locator="261:1-272:9" name="AssociateDiagnosticReports" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="878">
               <a:s>// TODO: Parameterize by association window (currently hard-coded to 1 day)
define function AssociateDiagnosticReports(d1 FHIR.DiagnosticReport, d2 FHIR.DiagnosticReport):
  </a:s>
               <a:s r="883">
                  <a:s r="883">
                     <a:s>if </a:s>
                     <a:s r="884">
                        <a:s>(
    </a:s>
                        <a:s r="884">
                           <a:s r="885">
                              <a:s r="886">
                                 <a:s r="887">
                                    <a:s r="888">
                                       <a:s r="910">
                                          <a:s r="893">
                                             <a:s r="889">
                                                <a:s>(</a:s>
                                                <a:s r="889">
                                                   <a:s r="891">
                                                      <a:s r="890">
                                                         <a:s>d1</a:s>
                                                      </a:s>
                                                      <a:s>.</a:s>
                                                      <a:s r="891">
                                                         <a:s>effective</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s> as </a:s>
                                                   <a:s r="892">
                                                      <a:s>FHIR.dateTime</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="893">
                                                <a:s>value</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> </a:s>
                                          <a:s r="910">
                                             <a:s>within </a:s>
                                             <a:s r="899">
                                                <a:s>1 day</a:s>
                                             </a:s>
                                             <a:s> of</a:s>
                                          </a:s>
                                          <a:s> </a:s>
                                          <a:s r="898">
                                             <a:s r="894">
                                                <a:s>(</a:s>
                                                <a:s r="894">
                                                   <a:s r="896">
                                                      <a:s r="895">
                                                         <a:s>d2</a:s>
                                                      </a:s>
                                                      <a:s>.</a:s>
                                                      <a:s r="896">
                                                         <a:s>effective</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s> as </a:s>
                                                   <a:s r="897">
                                                      <a:s>FHIR.dateTime</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="898">
                                                <a:s>value</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> or
    </a:s>
                                       <a:s r="933">
                                          <a:s r="915">
                                             <a:s r="911">
                                                <a:s>(</a:s>
                                                <a:s r="911">
                                                   <a:s r="913">
                                                      <a:s r="912">
                                                         <a:s>d1</a:s>
                                                      </a:s>
                                                      <a:s>.</a:s>
                                                      <a:s r="913">
                                                         <a:s>effective</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s> as </a:s>
                                                   <a:s r="914">
                                                      <a:s>FHIR.dateTime</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="915">
                                                <a:s>value</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> </a:s>
                                          <a:s r="933">
                                             <a:s>within </a:s>
                                             <a:s r="922">
                                                <a:s>1 day</a:s>
                                             </a:s>
                                             <a:s> of</a:s>
                                          </a:s>
                                          <a:s> </a:s>
                                          <a:s r="921">
                                             <a:s r="920">
                                                <a:s r="916">
                                                   <a:s>(</a:s>
                                                   <a:s r="916">
                                                      <a:s r="918">
                                                         <a:s r="917">
                                                            <a:s>d2</a:s>
                                                         </a:s>
                                                         <a:s>.</a:s>
                                                         <a:s r="918">
                                                            <a:s>effective</a:s>
                                                         </a:s>
                                                      </a:s>
                                                      <a:s> as </a:s>
                                                      <a:s r="919">
                                                         <a:s>FHIR.Period</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s>)</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="920">
                                                   <a:s>&quot;start&quot;</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="921">
                                                <a:s>value</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> or 
    </a:s>
                                    <a:s r="956">
                                       <a:s r="938">
                                          <a:s r="934">
                                             <a:s>(</a:s>
                                             <a:s r="934">
                                                <a:s r="936">
                                                   <a:s r="935">
                                                      <a:s>d1</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="936">
                                                      <a:s>effective</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> as </a:s>
                                                <a:s r="937">
                                                   <a:s>FHIR.dateTime</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="938">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="956">
                                          <a:s>within </a:s>
                                          <a:s r="945">
                                             <a:s>1 day</a:s>
                                          </a:s>
                                          <a:s> of</a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="944">
                                          <a:s r="943">
                                             <a:s r="939">
                                                <a:s>(</a:s>
                                                <a:s r="939">
                                                   <a:s r="941">
                                                      <a:s r="940">
                                                         <a:s>d2</a:s>
                                                      </a:s>
                                                      <a:s>.</a:s>
                                                      <a:s r="941">
                                                         <a:s>effective</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s> as </a:s>
                                                   <a:s r="942">
                                                      <a:s>FHIR.Period</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="943">
                                                <a:s>&quot;end&quot;</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="944">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> or
    </a:s>
                                 <a:s r="979">
                                    <a:s r="961">
                                       <a:s r="957">
                                          <a:s>(</a:s>
                                          <a:s r="957">
                                             <a:s r="959">
                                                <a:s r="958">
                                                   <a:s>d2</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="959">
                                                   <a:s>effective</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> as </a:s>
                                             <a:s r="960">
                                                <a:s>FHIR.dateTime</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="961">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> </a:s>
                                    <a:s r="979">
                                       <a:s>within </a:s>
                                       <a:s r="968">
                                          <a:s>1 day</a:s>
                                       </a:s>
                                       <a:s> of</a:s>
                                    </a:s>
                                    <a:s> </a:s>
                                    <a:s r="967">
                                       <a:s r="966">
                                          <a:s r="962">
                                             <a:s>(</a:s>
                                             <a:s r="962">
                                                <a:s r="964">
                                                   <a:s r="963">
                                                      <a:s>d1</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="964">
                                                      <a:s>effective</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> as </a:s>
                                                <a:s r="965">
                                                   <a:s>FHIR.Period</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="966">
                                             <a:s>&quot;start&quot;</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="967">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s> or 
    </a:s>
                              <a:s r="1002">
                                 <a:s r="984">
                                    <a:s r="980">
                                       <a:s>(</a:s>
                                       <a:s r="980">
                                          <a:s r="982">
                                             <a:s r="981">
                                                <a:s>d2</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="982">
                                                <a:s>effective</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> as </a:s>
                                          <a:s r="983">
                                             <a:s>FHIR.dateTime</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="984">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> </a:s>
                                 <a:s r="1002">
                                    <a:s>within </a:s>
                                    <a:s r="991">
                                       <a:s>1 day</a:s>
                                    </a:s>
                                    <a:s> of</a:s>
                                 </a:s>
                                 <a:s> </a:s>
                                 <a:s r="990">
                                    <a:s r="989">
                                       <a:s r="985">
                                          <a:s>(</a:s>
                                          <a:s r="985">
                                             <a:s r="987">
                                                <a:s r="986">
                                                   <a:s>d1</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="987">
                                                   <a:s>effective</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> as </a:s>
                                             <a:s r="988">
                                                <a:s>FHIR.Period</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="989">
                                          <a:s>&quot;end&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="990">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s> or
    </a:s>
                           <a:s r="1011">
                              <a:s r="1003">
                                 <a:s>(</a:s>
                                 <a:s r="1003">
                                    <a:s r="1005">
                                       <a:s r="1004">
                                          <a:s>d1</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1005">
                                          <a:s>effective</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> as </a:s>
                                    <a:s r="1006">
                                       <a:s>FHIR.Period</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s r="1011"> overlaps </a:s>
                              <a:s r="1007">
                                 <a:s>(</a:s>
                                 <a:s r="1007">
                                    <a:s r="1009">
                                       <a:s r="1008">
                                          <a:s>d2</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1009">
                                          <a:s>effective</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> as </a:s>
                                    <a:s r="1010">
                                       <a:s>FHIR.Period</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  )</a:s>
                     </a:s>
                     <a:s r="1016"> then
    true
  else
    false</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="883" locator="262:3-272:9" xsi:type="If">
            <condition localId="884" locator="262:6-269:3" xsi:type="Or">
               <operand localId="885" locator="263:5-267:99" xsi:type="Or">
                  <operand localId="886" locator="263:5-266:101" xsi:type="Or">
                     <operand localId="887" locator="263:5-265:99" xsi:type="Or">
                        <operand localId="888" locator="263:5-264:101" xsi:type="Or">
                           <operand localId="910" locator="263:5-263:95" xsi:type="And">
                              <operand localId="907" xsi:type="In">
                                 <operand localId="893" locator="263:5-263:41" path="value" xsi:type="Property">
                                    <source localId="889" locator="263:5-263:35" strict="false" xsi:type="As">
                                       <operand localId="891" locator="263:6-263:17" path="effective" xsi:type="Property">
                                          <source localId="890" locator="263:6-263:7" name="d1" xsi:type="OperandRef"/>
                                       </operand>
                                       <asTypeSpecifier localId="892" locator="263:22-263:34" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                    </source>
                                 </operand>
                                 <operand localId="906" locator="263:50-263:54" lowClosed="true" highClosed="true" xsi:type="Interval">
                                    <low localId="900" locator="263:50-263:54" xsi:type="Subtract">
                                       <signature localId="901" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                       <signature localId="902" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="898" locator="263:59-263:95" path="value" xsi:type="Property">
                                          <source localId="894" locator="263:59-263:89" strict="false" xsi:type="As">
                                             <operand localId="896" locator="263:60-263:71" path="effective" xsi:type="Property">
                                                <source localId="895" locator="263:60-263:61" name="d2" xsi:type="OperandRef"/>
                                             </operand>
                                             <asTypeSpecifier localId="897" locator="263:76-263:88" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                          </source>
                                       </operand>
                                       <operand localId="899" locator="263:50-263:54" value="1" unit="day" xsi:type="Quantity"/>
                                    </low>
                                    <high localId="903" locator="263:50-263:54" xsi:type="Add">
                                       <signature localId="904" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                       <signature localId="905" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="898" locator="263:59-263:95" path="value" xsi:type="Property">
                                          <source localId="894" locator="263:59-263:89" strict="false" xsi:type="As">
                                             <operand localId="896" locator="263:60-263:71" path="effective" xsi:type="Property">
                                                <source localId="895" locator="263:60-263:61" name="d2" xsi:type="OperandRef"/>
                                             </operand>
                                             <asTypeSpecifier localId="897" locator="263:76-263:88" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                          </source>
                                       </operand>
                                       <operand localId="899" locator="263:50-263:54" value="1" unit="day" xsi:type="Quantity"/>
                                    </high>
                                 </operand>
                              </operand>
                              <operand localId="909" locator="263:50-263:54" xsi:type="Not">
                                 <operand localId="908" locator="263:50-263:54" xsi:type="IsNull">
                                    <operand localId="898" locator="263:59-263:95" path="value" xsi:type="Property">
                                       <source localId="894" locator="263:59-263:89" strict="false" xsi:type="As">
                                          <operand localId="896" locator="263:60-263:71" path="effective" xsi:type="Property">
                                             <source localId="895" locator="263:60-263:61" name="d2" xsi:type="OperandRef"/>
                                          </operand>
                                          <asTypeSpecifier localId="897" locator="263:76-263:88" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                       </source>
                                    </operand>
                                 </operand>
                              </operand>
                           </operand>
                           <operand localId="933" locator="264:5-264:101" xsi:type="And">
                              <operand localId="930" xsi:type="In">
                                 <operand localId="915" locator="264:5-264:41" path="value" xsi:type="Property">
                                    <source localId="911" locator="264:5-264:35" strict="false" xsi:type="As">
                                       <operand localId="913" locator="264:6-264:17" path="effective" xsi:type="Property">
                                          <source localId="912" locator="264:6-264:7" name="d1" xsi:type="OperandRef"/>
                                       </operand>
                                       <asTypeSpecifier localId="914" locator="264:22-264:34" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                    </source>
                                 </operand>
                                 <operand localId="929" locator="264:50-264:54" lowClosed="true" highClosed="true" xsi:type="Interval">
                                    <low localId="923" locator="264:50-264:54" xsi:type="Subtract">
                                       <signature localId="924" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                       <signature localId="925" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="921" locator="264:59-264:101" path="value" xsi:type="Property">
                                          <source localId="920" locator="264:59-264:95" path="start" xsi:type="Property">
                                             <source localId="916" locator="264:59-264:87" strict="false" xsi:type="As">
                                                <operand localId="918" locator="264:60-264:71" path="effective" xsi:type="Property">
                                                   <source localId="917" locator="264:60-264:61" name="d2" xsi:type="OperandRef"/>
                                                </operand>
                                                <asTypeSpecifier localId="919" locator="264:76-264:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                             </source>
                                          </source>
                                       </operand>
                                       <operand localId="922" locator="264:50-264:54" value="1" unit="day" xsi:type="Quantity"/>
                                    </low>
                                    <high localId="926" locator="264:50-264:54" xsi:type="Add">
                                       <signature localId="927" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                       <signature localId="928" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="921" locator="264:59-264:101" path="value" xsi:type="Property">
                                          <source localId="920" locator="264:59-264:95" path="start" xsi:type="Property">
                                             <source localId="916" locator="264:59-264:87" strict="false" xsi:type="As">
                                                <operand localId="918" locator="264:60-264:71" path="effective" xsi:type="Property">
                                                   <source localId="917" locator="264:60-264:61" name="d2" xsi:type="OperandRef"/>
                                                </operand>
                                                <asTypeSpecifier localId="919" locator="264:76-264:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                             </source>
                                          </source>
                                       </operand>
                                       <operand localId="922" locator="264:50-264:54" value="1" unit="day" xsi:type="Quantity"/>
                                    </high>
                                 </operand>
                              </operand>
                              <operand localId="932" locator="264:50-264:54" xsi:type="Not">
                                 <operand localId="931" locator="264:50-264:54" xsi:type="IsNull">
                                    <operand localId="921" locator="264:59-264:101" path="value" xsi:type="Property">
                                       <source localId="920" locator="264:59-264:95" path="start" xsi:type="Property">
                                          <source localId="916" locator="264:59-264:87" strict="false" xsi:type="As">
                                             <operand localId="918" locator="264:60-264:71" path="effective" xsi:type="Property">
                                                <source localId="917" locator="264:60-264:61" name="d2" xsi:type="OperandRef"/>
                                             </operand>
                                             <asTypeSpecifier localId="919" locator="264:76-264:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                          </source>
                                       </source>
                                    </operand>
                                 </operand>
                              </operand>
                           </operand>
                        </operand>
                        <operand localId="956" locator="265:5-265:99" xsi:type="And">
                           <operand localId="953" xsi:type="In">
                              <operand localId="938" locator="265:5-265:41" path="value" xsi:type="Property">
                                 <source localId="934" locator="265:5-265:35" strict="false" xsi:type="As">
                                    <operand localId="936" locator="265:6-265:17" path="effective" xsi:type="Property">
                                       <source localId="935" locator="265:6-265:7" name="d1" xsi:type="OperandRef"/>
                                    </operand>
                                    <asTypeSpecifier localId="937" locator="265:22-265:34" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                 </source>
                              </operand>
                              <operand localId="952" locator="265:50-265:54" lowClosed="true" highClosed="true" xsi:type="Interval">
                                 <low localId="946" locator="265:50-265:54" xsi:type="Subtract">
                                    <signature localId="947" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                    <signature localId="948" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="944" locator="265:59-265:99" path="value" xsi:type="Property">
                                       <source localId="943" locator="265:59-265:93" path="end" xsi:type="Property">
                                          <source localId="939" locator="265:59-265:87" strict="false" xsi:type="As">
                                             <operand localId="941" locator="265:60-265:71" path="effective" xsi:type="Property">
                                                <source localId="940" locator="265:60-265:61" name="d2" xsi:type="OperandRef"/>
                                             </operand>
                                             <asTypeSpecifier localId="942" locator="265:76-265:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                          </source>
                                       </source>
                                    </operand>
                                    <operand localId="945" locator="265:50-265:54" value="1" unit="day" xsi:type="Quantity"/>
                                 </low>
                                 <high localId="949" locator="265:50-265:54" xsi:type="Add">
                                    <signature localId="950" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                    <signature localId="951" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="944" locator="265:59-265:99" path="value" xsi:type="Property">
                                       <source localId="943" locator="265:59-265:93" path="end" xsi:type="Property">
                                          <source localId="939" locator="265:59-265:87" strict="false" xsi:type="As">
                                             <operand localId="941" locator="265:60-265:71" path="effective" xsi:type="Property">
                                                <source localId="940" locator="265:60-265:61" name="d2" xsi:type="OperandRef"/>
                                             </operand>
                                             <asTypeSpecifier localId="942" locator="265:76-265:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                          </source>
                                       </source>
                                    </operand>
                                    <operand localId="945" locator="265:50-265:54" value="1" unit="day" xsi:type="Quantity"/>
                                 </high>
                              </operand>
                           </operand>
                           <operand localId="955" locator="265:50-265:54" xsi:type="Not">
                              <operand localId="954" locator="265:50-265:54" xsi:type="IsNull">
                                 <operand localId="944" locator="265:59-265:99" path="value" xsi:type="Property">
                                    <source localId="943" locator="265:59-265:93" path="end" xsi:type="Property">
                                       <source localId="939" locator="265:59-265:87" strict="false" xsi:type="As">
                                          <operand localId="941" locator="265:60-265:71" path="effective" xsi:type="Property">
                                             <source localId="940" locator="265:60-265:61" name="d2" xsi:type="OperandRef"/>
                                          </operand>
                                          <asTypeSpecifier localId="942" locator="265:76-265:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                       </source>
                                    </source>
                                 </operand>
                              </operand>
                           </operand>
                        </operand>
                     </operand>
                     <operand localId="979" locator="266:5-266:101" xsi:type="And">
                        <operand localId="976" xsi:type="In">
                           <operand localId="961" locator="266:5-266:41" path="value" xsi:type="Property">
                              <source localId="957" locator="266:5-266:35" strict="false" xsi:type="As">
                                 <operand localId="959" locator="266:6-266:17" path="effective" xsi:type="Property">
                                    <source localId="958" locator="266:6-266:7" name="d2" xsi:type="OperandRef"/>
                                 </operand>
                                 <asTypeSpecifier localId="960" locator="266:22-266:34" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                              </source>
                           </operand>
                           <operand localId="975" locator="266:50-266:54" lowClosed="true" highClosed="true" xsi:type="Interval">
                              <low localId="969" locator="266:50-266:54" xsi:type="Subtract">
                                 <signature localId="970" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 <signature localId="971" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="967" locator="266:59-266:101" path="value" xsi:type="Property">
                                    <source localId="966" locator="266:59-266:95" path="start" xsi:type="Property">
                                       <source localId="962" locator="266:59-266:87" strict="false" xsi:type="As">
                                          <operand localId="964" locator="266:60-266:71" path="effective" xsi:type="Property">
                                             <source localId="963" locator="266:60-266:61" name="d1" xsi:type="OperandRef"/>
                                          </operand>
                                          <asTypeSpecifier localId="965" locator="266:76-266:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                       </source>
                                    </source>
                                 </operand>
                                 <operand localId="968" locator="266:50-266:54" value="1" unit="day" xsi:type="Quantity"/>
                              </low>
                              <high localId="972" locator="266:50-266:54" xsi:type="Add">
                                 <signature localId="973" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 <signature localId="974" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="967" locator="266:59-266:101" path="value" xsi:type="Property">
                                    <source localId="966" locator="266:59-266:95" path="start" xsi:type="Property">
                                       <source localId="962" locator="266:59-266:87" strict="false" xsi:type="As">
                                          <operand localId="964" locator="266:60-266:71" path="effective" xsi:type="Property">
                                             <source localId="963" locator="266:60-266:61" name="d1" xsi:type="OperandRef"/>
                                          </operand>
                                          <asTypeSpecifier localId="965" locator="266:76-266:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                       </source>
                                    </source>
                                 </operand>
                                 <operand localId="968" locator="266:50-266:54" value="1" unit="day" xsi:type="Quantity"/>
                              </high>
                           </operand>
                        </operand>
                        <operand localId="978" locator="266:50-266:54" xsi:type="Not">
                           <operand localId="977" locator="266:50-266:54" xsi:type="IsNull">
                              <operand localId="967" locator="266:59-266:101" path="value" xsi:type="Property">
                                 <source localId="966" locator="266:59-266:95" path="start" xsi:type="Property">
                                    <source localId="962" locator="266:59-266:87" strict="false" xsi:type="As">
                                       <operand localId="964" locator="266:60-266:71" path="effective" xsi:type="Property">
                                          <source localId="963" locator="266:60-266:61" name="d1" xsi:type="OperandRef"/>
                                       </operand>
                                       <asTypeSpecifier localId="965" locator="266:76-266:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                    </source>
                                 </source>
                              </operand>
                           </operand>
                        </operand>
                     </operand>
                  </operand>
                  <operand localId="1002" locator="267:5-267:99" xsi:type="And">
                     <operand localId="999" xsi:type="In">
                        <operand localId="984" locator="267:5-267:41" path="value" xsi:type="Property">
                           <source localId="980" locator="267:5-267:35" strict="false" xsi:type="As">
                              <operand localId="982" locator="267:6-267:17" path="effective" xsi:type="Property">
                                 <source localId="981" locator="267:6-267:7" name="d2" xsi:type="OperandRef"/>
                              </operand>
                              <asTypeSpecifier localId="983" locator="267:22-267:34" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           </source>
                        </operand>
                        <operand localId="998" locator="267:50-267:54" lowClosed="true" highClosed="true" xsi:type="Interval">
                           <low localId="992" locator="267:50-267:54" xsi:type="Subtract">
                              <signature localId="993" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              <signature localId="994" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="990" locator="267:59-267:99" path="value" xsi:type="Property">
                                 <source localId="989" locator="267:59-267:93" path="end" xsi:type="Property">
                                    <source localId="985" locator="267:59-267:87" strict="false" xsi:type="As">
                                       <operand localId="987" locator="267:60-267:71" path="effective" xsi:type="Property">
                                          <source localId="986" locator="267:60-267:61" name="d1" xsi:type="OperandRef"/>
                                       </operand>
                                       <asTypeSpecifier localId="988" locator="267:76-267:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                    </source>
                                 </source>
                              </operand>
                              <operand localId="991" locator="267:50-267:54" value="1" unit="day" xsi:type="Quantity"/>
                           </low>
                           <high localId="995" locator="267:50-267:54" xsi:type="Add">
                              <signature localId="996" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              <signature localId="997" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="990" locator="267:59-267:99" path="value" xsi:type="Property">
                                 <source localId="989" locator="267:59-267:93" path="end" xsi:type="Property">
                                    <source localId="985" locator="267:59-267:87" strict="false" xsi:type="As">
                                       <operand localId="987" locator="267:60-267:71" path="effective" xsi:type="Property">
                                          <source localId="986" locator="267:60-267:61" name="d1" xsi:type="OperandRef"/>
                                       </operand>
                                       <asTypeSpecifier localId="988" locator="267:76-267:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                    </source>
                                 </source>
                              </operand>
                              <operand localId="991" locator="267:50-267:54" value="1" unit="day" xsi:type="Quantity"/>
                           </high>
                        </operand>
                     </operand>
                     <operand localId="1001" locator="267:50-267:54" xsi:type="Not">
                        <operand localId="1000" locator="267:50-267:54" xsi:type="IsNull">
                           <operand localId="990" locator="267:59-267:99" path="value" xsi:type="Property">
                              <source localId="989" locator="267:59-267:93" path="end" xsi:type="Property">
                                 <source localId="985" locator="267:59-267:87" strict="false" xsi:type="As">
                                    <operand localId="987" locator="267:60-267:71" path="effective" xsi:type="Property">
                                       <source localId="986" locator="267:60-267:61" name="d1" xsi:type="OperandRef"/>
                                    </operand>
                                    <asTypeSpecifier localId="988" locator="267:76-267:86" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                 </source>
                              </source>
                           </operand>
                        </operand>
                     </operand>
                  </operand>
               </operand>
               <operand localId="1011" locator="268:5-268:72" xsi:type="Overlaps">
                  <operand localId="1012" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature localId="1013" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1003" locator="268:5-268:33" strict="false" xsi:type="As">
                        <operand localId="1005" locator="268:6-268:17" path="effective" xsi:type="Property">
                           <source localId="1004" locator="268:6-268:7" name="d1" xsi:type="OperandRef"/>
                        </operand>
                        <asTypeSpecifier localId="1006" locator="268:22-268:32" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     </operand>
                  </operand>
                  <operand localId="1014" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature localId="1015" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1007" locator="268:44-268:72" strict="false" xsi:type="As">
                        <operand localId="1009" locator="268:45-268:56" path="effective" xsi:type="Property">
                           <source localId="1008" locator="268:45-268:46" name="d2" xsi:type="OperandRef"/>
                        </operand>
                        <asTypeSpecifier localId="1010" locator="268:61-268:71" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     </operand>
                  </operand>
               </operand>
            </condition>
            <then localId="1016" locator="270:5-270:8" valueType="t:Boolean" value="true" xsi:type="Literal"/>
            <else localId="1017" locator="272:5-272:9" valueType="t:Boolean" value="false" xsi:type="Literal"/>
         </expression>
         <operand localId="880" name="d1">
            <operandTypeSpecifier localId="879" locator="261:47-261:67" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand localId="882" name="d2">
            <operandTypeSpecifier localId="881" locator="261:73-261:93" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1018" locator="274:1-285:9" name="CoincidentDiagnosticReports" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1018">
               <a:s>define function CoincidentDiagnosticReports(d1 FHIR.DiagnosticReport, d2 FHIR.DiagnosticReport):
  </a:s>
               <a:s r="1023">
                  <a:s r="1023">
                     <a:s>if </a:s>
                     <a:s r="1024">
                        <a:s>(
    </a:s>
                        <a:s r="1024">
                           <a:s r="1025">
                              <a:s r="1028">
                                 <a:s>AssociateDiagnosticReports(</a:s>
                                 <a:s r="1026">
                                    <a:s>d1</a:s>
                                 </a:s>
                                 <a:s>, </a:s>
                                 <a:s r="1027">
                                    <a:s>d2</a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s> or
    </a:s>
                              <a:s r="1029">
                                 <a:s r="1031">
                                    <a:s r="1030">
                                       <a:s>d1</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1031">
                                       <a:s>encounter</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> = </a:s>
                                 <a:s r="1033">
                                    <a:s r="1032">
                                       <a:s>d2</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1033">
                                       <a:s>encounter</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s> or
    </a:s>
                           <a:s r="1036">
                              <a:s>(
      </a:s>
                              <a:s r="1036">
                                 <a:s r="1056">
                                    <a:s>Coalesce(</a:s>
                                    <a:s r="1051">
                                       <a:s>
                                          <a:s r="1037">
                                             <a:s r="1039">
                                                <a:s>(</a:s>
                                                <a:s r="1039">
                                                   <a:s r="1038">
                                                      <a:s>d1</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="1039">
                                                      <a:s>basedOn</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                             <a:s> R</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="1040">
                                          <a:s>where </a:s>
                                          <a:s r="1040">
                                             <a:s r="1042">
                                                <a:s r="1041">
                                                   <a:s>R</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="1042">
                                                   <a:s>type</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> = </a:s>
                                             <a:s r="1043">
                                                <a:s>'ServiceRequest'</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="1048">
                                          <a:s>return </a:s>
                                          <a:s r="1050">
                                             <a:s r="1049">
                                                <a:s>R</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="1050">
                                                <a:s>reference</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s> =
      </a:s>
                                 <a:s r="1078">
                                    <a:s>Coalesce(</a:s>
                                    <a:s r="1073">
                                       <a:s>
                                          <a:s r="1059">
                                             <a:s r="1061">
                                                <a:s>(</a:s>
                                                <a:s r="1061">
                                                   <a:s r="1060">
                                                      <a:s>d2</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="1061">
                                                      <a:s>basedOn</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                             <a:s> R</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="1062">
                                          <a:s>where </a:s>
                                          <a:s r="1062">
                                             <a:s r="1064">
                                                <a:s r="1063">
                                                   <a:s>R</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="1064">
                                                   <a:s>type</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> = </a:s>
                                             <a:s r="1065">
                                                <a:s>'ServiceRequest'</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="1070">
                                          <a:s>return </a:s>
                                          <a:s r="1072">
                                             <a:s r="1071">
                                                <a:s>R</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="1072">
                                                <a:s>reference</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
    )</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  )</a:s>
                     </a:s>
                     <a:s r="1083"> then
    true
  else
    false</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1023" locator="275:3-285:9" xsi:type="If">
            <condition localId="1024" locator="275:6-282:3" xsi:type="Or">
               <operand localId="1025" locator="276:5-277:31" xsi:type="Or">
                  <operand localId="1028" locator="276:5-276:38" name="AssociateDiagnosticReports" xsi:type="FunctionRef">
                     <operand localId="1026" locator="276:32-276:33" name="d1" xsi:type="OperandRef"/>
                     <operand localId="1027" locator="276:36-276:37" name="d2" xsi:type="OperandRef"/>
                  </operand>
                  <operand localId="1029" locator="277:5-277:31" xsi:type="Equal">
                     <signature localId="1034" name="fhir:Reference" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1035" name="fhir:Reference" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1031" locator="277:5-277:16" path="encounter" xsi:type="Property">
                        <source localId="1030" locator="277:5-277:6" name="d1" xsi:type="OperandRef"/>
                     </operand>
                     <operand localId="1033" locator="277:20-277:31" path="encounter" xsi:type="Property">
                        <source localId="1032" locator="277:20-277:21" name="d2" xsi:type="OperandRef"/>
                     </operand>
                  </operand>
               </operand>
               <operand localId="1036" locator="278:5-281:5" xsi:type="Equal">
                  <signature localId="1081" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1082" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1056" locator="279:7-279:81" xsi:type="Coalesce">
                     <signature localId="1057" xsi:type="ListTypeSpecifier">
                        <elementType localId="1058" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="1051" locator="279:16-279:80" xsi:type="Query">
                        <source localId="1037" locator="279:16-279:29" alias="R">
                           <expression localId="1039" locator="279:16-279:27" path="basedOn" xsi:type="Property">
                              <source localId="1038" locator="279:17-279:18" name="d1" xsi:type="OperandRef"/>
                           </expression>
                        </source>
                        <where localId="1040" locator="279:31-279:61" xsi:type="Equal">
                           <signature localId="1046" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <signature localId="1047" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="1044" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature localId="1045" name="fhir:uri" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="1042" locator="279:37-279:42" path="type" scope="R" xsi:type="Property"/>
                           </operand>
                           <operand localId="1043" locator="279:46-279:61" valueType="t:String" value="ServiceRequest" xsi:type="Literal"/>
                        </where>
                        <return localId="1048" locator="279:63-279:80">
                           <expression localId="1050" locator="279:70-279:80" path="reference" scope="R" xsi:type="Property"/>
                        </return>
                     </operand>
                  </operand>
                  <operand localId="1078" locator="280:7-280:81" xsi:type="Coalesce">
                     <signature localId="1079" xsi:type="ListTypeSpecifier">
                        <elementType localId="1080" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="1073" locator="280:16-280:80" xsi:type="Query">
                        <source localId="1059" locator="280:16-280:29" alias="R">
                           <expression localId="1061" locator="280:16-280:27" path="basedOn" xsi:type="Property">
                              <source localId="1060" locator="280:17-280:18" name="d2" xsi:type="OperandRef"/>
                           </expression>
                        </source>
                        <where localId="1062" locator="280:31-280:61" xsi:type="Equal">
                           <signature localId="1068" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <signature localId="1069" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="1066" name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature localId="1067" name="fhir:uri" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="1064" locator="280:37-280:42" path="type" scope="R" xsi:type="Property"/>
                           </operand>
                           <operand localId="1065" locator="280:46-280:61" valueType="t:String" value="ServiceRequest" xsi:type="Literal"/>
                        </where>
                        <return localId="1070" locator="280:63-280:80">
                           <expression localId="1072" locator="280:70-280:80" path="reference" scope="R" xsi:type="Property"/>
                        </return>
                     </operand>
                  </operand>
               </operand>
            </condition>
            <then localId="1083" locator="283:5-283:8" valueType="t:Boolean" value="true" xsi:type="Literal"/>
            <else localId="1084" locator="285:5-285:9" valueType="t:Boolean" value="false" xsi:type="Literal"/>
         </expression>
         <operand localId="1020" name="d1">
            <operandTypeSpecifier localId="1019" locator="274:48-274:68" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand localId="1022" name="d2">
            <operandTypeSpecifier localId="1021" locator="274:74-274:94" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1085" locator="298:1-302:36" name="RelevantEncounterStatus" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1085">
               <a:s>/*******************************************************************************
* Encounter Functions
*******************************************************************************/

/**
 * Encounters that are triaged, in-progress or completed.
 * @see http://hl7.org/fhir/R4/valueset-encounter-status.html
 * @param EncList - a list of Encounters
 * @returns {List&lt;Encounter>} a list of encounters, or null if null was passed in
 */
define function RelevantEncounterStatus(EncList List&lt;Encounter>):
  </a:s>
               <a:s r="1114">
                  <a:s r="1114">
                     <a:s>
                        <a:s r="1089">
                           <a:s r="1090">
                              <a:s>
                                 <a:s>EncList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> E</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1091">
                        <a:s>where </a:s>
                        <a:s r="1091">
                           <a:s r="1092">
                              <a:s r="1093">
                                 <a:s r="1096">
                                    <a:s r="1095">
                                       <a:s r="1094">
                                          <a:s>E</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1095">
                                          <a:s>status</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1096">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> = </a:s>
                                 <a:s r="1097">
                                    <a:s>'triaged'</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
      or </a:s>
                              <a:s r="1100">
                                 <a:s r="1103">
                                    <a:s r="1102">
                                       <a:s r="1101">
                                          <a:s>E</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1102">
                                          <a:s>status</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1103">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> = </a:s>
                                 <a:s r="1104">
                                    <a:s>'in-progress'</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      or </a:s>
                           <a:s r="1107">
                              <a:s r="1110">
                                 <a:s r="1109">
                                    <a:s r="1108">
                                       <a:s>E</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1109">
                                       <a:s>status</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1110">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> = </a:s>
                              <a:s r="1111">
                                 <a:s>'finished'</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1114" locator="299:3-302:36" xsi:type="Query">
            <source localId="1089" locator="299:3-299:11" alias="E">
               <expression localId="1090" locator="299:3-299:9" name="EncList" xsi:type="OperandRef"/>
            </source>
            <where localId="1091" locator="300:5-302:36" xsi:type="Or">
               <operand localId="1092" locator="300:11-301:39" xsi:type="Or">
                  <operand localId="1093" locator="300:11-300:36" xsi:type="Equal">
                     <signature localId="1098" name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1099" name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1096" locator="300:11-300:24" path="value" xsi:type="Property">
                        <source localId="1095" locator="300:11-300:18" path="status" scope="E" xsi:type="Property"/>
                     </operand>
                     <operand localId="1097" locator="300:28-300:36" valueType="t:String" value="triaged" xsi:type="Literal"/>
                  </operand>
                  <operand localId="1100" locator="301:10-301:39" xsi:type="Equal">
                     <signature localId="1105" name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1106" name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1103" locator="301:10-301:23" path="value" xsi:type="Property">
                        <source localId="1102" locator="301:10-301:17" path="status" scope="E" xsi:type="Property"/>
                     </operand>
                     <operand localId="1104" locator="301:27-301:39" valueType="t:String" value="in-progress" xsi:type="Literal"/>
                  </operand>
               </operand>
               <operand localId="1107" locator="302:10-302:36" xsi:type="Equal">
                  <signature localId="1112" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1113" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1110" locator="302:10-302:23" path="value" xsi:type="Property">
                     <source localId="1109" locator="302:10-302:17" path="status" scope="E" xsi:type="Property"/>
                  </operand>
                  <operand localId="1111" locator="302:27-302:36" valueType="t:String" value="finished" xsi:type="Literal"/>
               </operand>
            </where>
         </expression>
         <operand localId="1088" name="EncList">
            <operandTypeSpecifier localId="1086" locator="298:49-298:63" xsi:type="ListTypeSpecifier">
               <elementType localId="1087" locator="298:54-298:62" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1115" locator="313:1-318:3" name="MedicationAdministrationDate" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1115">
               <a:s>/*******************************************************************************
* Medication Functions
*******************************************************************************/

// Returns a text representation of a date associated with a MedicationAdministration, preferring `effectiveDateTime`, then
// `.start`.
// @param s - a FHIR MedicationAdministration to get the text date from
// @returns {System.String} the text representation of a relevant date from the MedicationAdministration
define function MedicationAdministrationDate(a FHIR.MedicationAdministration):
  </a:s>
               <a:s r="1140">
                  <a:s r="1140">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="1122">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="1118">
                           <a:s r="1120">
                              <a:s r="1119">
                                 <a:s>a</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1120">
                                 <a:s>effective</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="1121">
                              <a:s>FHIR.dateTime</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="1128">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="1127">
                           <a:s r="1123">
                              <a:s>(</a:s>
                              <a:s r="1123">
                                 <a:s r="1125">
                                    <a:s r="1124">
                                       <a:s>a</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1125">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="1126">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1127">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="1134">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="1133">
                           <a:s r="1129">
                              <a:s>(</a:s>
                              <a:s r="1129">
                                 <a:s r="1131">
                                    <a:s r="1130">
                                       <a:s>a</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1131">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="1132">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1133">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1140" locator="314:3-318:3" xsi:type="Coalesce">
            <signature localId="1141" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="1142" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="1143" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <operand localId="1122" locator="315:5-315:46" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="1118" locator="315:18-315:45" strict="false" xsi:type="As">
                  <operand localId="1120" locator="315:18-315:28" path="effective" xsi:type="Property">
                     <source localId="1119" locator="315:18" name="a" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="1121" locator="315:33-315:45" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
            <operand localId="1128" locator="316:5-316:52" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="1127" locator="316:18-316:51" path="end" xsi:type="Property">
                  <source localId="1123" locator="316:18-316:45" strict="false" xsi:type="As">
                     <operand localId="1125" locator="316:19-316:29" path="effective" xsi:type="Property">
                        <source localId="1124" locator="316:19" name="a" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="1126" locator="316:34-316:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
            <operand localId="1134" locator="317:5-317:54" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="1133" locator="317:18-317:53" path="start" xsi:type="Property">
                  <source localId="1129" locator="317:18-317:45" strict="false" xsi:type="As">
                     <operand localId="1131" locator="317:19-317:29" path="effective" xsi:type="Property">
                        <source localId="1130" locator="317:19" name="a" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="1132" locator="317:34-317:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
         </expression>
         <operand localId="1117" name="a">
            <operandTypeSpecifier localId="1116" locator="313:48-313:76" name="fhir:MedicationAdministration" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1144" locator="326:1-328:38" name="CompletedMedicationAdministration" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1144">
               <a:s>/**
* Medication administrations that are completed, according to a prescription.
* @see https://www.hl7.org/fhir/valueset-medication-admin-status.html
* @param MedList - a list of MedicationAdministrations
* @returns {List&lt;MedicationAdministration>} a list of completed medication administrations, or null if null was passed in
*/
define function CompletedMedicationAdministration(MedList List&lt;MedicationAdministration>):
  </a:s>
               <a:s r="1157">
                  <a:s r="1157">
                     <a:s>
                        <a:s r="1148">
                           <a:s r="1149">
                              <a:s>
                                 <a:s>MedList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> M</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1150">
                        <a:s>where </a:s>
                        <a:s r="1150">
                           <a:s r="1153">
                              <a:s r="1152">
                                 <a:s r="1151">
                                    <a:s>M</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1152">
                                    <a:s>status</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1153">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="1154">
                              <a:s>'completed'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1157" locator="327:3-328:38" xsi:type="Query">
            <source localId="1148" locator="327:3-327:11" alias="M">
               <expression localId="1149" locator="327:3-327:9" name="MedList" xsi:type="OperandRef"/>
            </source>
            <where localId="1150" locator="328:5-328:38" xsi:type="Equal">
               <signature localId="1155" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <signature localId="1156" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand localId="1153" locator="328:11-328:24" path="value" xsi:type="Property">
                  <source localId="1152" locator="328:11-328:18" path="status" scope="M" xsi:type="Property"/>
               </operand>
               <operand localId="1154" locator="328:28-328:38" valueType="t:String" value="completed" xsi:type="Literal"/>
            </where>
         </expression>
         <operand localId="1147" name="MedList">
            <operandTypeSpecifier localId="1145" locator="326:59-326:88" xsi:type="ListTypeSpecifier">
               <elementType localId="1146" locator="326:64-326:87" name="fhir:MedicationAdministration" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1158" locator="330:1-332:38" name="CompletedMedicationDispense" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1158">
               <a:s>define function CompletedMedicationDispense(MedList List&lt;MedicationDispense>):
  </a:s>
               <a:s r="1171">
                  <a:s r="1171">
                     <a:s>
                        <a:s r="1162">
                           <a:s r="1163">
                              <a:s>
                                 <a:s>MedList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> M</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1164">
                        <a:s>where </a:s>
                        <a:s r="1164">
                           <a:s r="1167">
                              <a:s r="1166">
                                 <a:s r="1165">
                                    <a:s>M</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1166">
                                    <a:s>status</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1167">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="1168">
                              <a:s>'completed'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1171" locator="331:3-332:38" xsi:type="Query">
            <source localId="1162" locator="331:3-331:11" alias="M">
               <expression localId="1163" locator="331:3-331:9" name="MedList" xsi:type="OperandRef"/>
            </source>
            <where localId="1164" locator="332:5-332:38" xsi:type="Equal">
               <signature localId="1169" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <signature localId="1170" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand localId="1167" locator="332:11-332:24" path="value" xsi:type="Property">
                  <source localId="1166" locator="332:11-332:18" path="status" scope="M" xsi:type="Property"/>
               </operand>
               <operand localId="1168" locator="332:28-332:38" valueType="t:String" value="completed" xsi:type="Literal"/>
            </where>
         </expression>
         <operand localId="1161" name="MedList">
            <operandTypeSpecifier localId="1159" locator="330:53-330:76" xsi:type="ListTypeSpecifier">
               <elementType localId="1160" locator="330:58-330:75" name="fhir:MedicationDispense" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1172" locator="340:1-342:77" name="CompletedDiagnosticReport" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1172">
               <a:s>/**
* Diagnostic reports that are completed.
* @see https://www.hl7.org/fhir/valueset-diagnostic-report-status.html
* @param DiagnosticReportList - a list of DiagnosticReports
* @returns {List&lt;DiagnosticReport>} a list of completed diagnostic reports, or null if null was passed in
*/
define function CompletedDiagnosticReport(DiagnosticReportList List&lt;DiagnosticReport>):
  </a:s>
               <a:s r="1190">
                  <a:s r="1190">
                     <a:s>
                        <a:s r="1176">
                           <a:s r="1177">
                              <a:s>
                                 <a:s>DiagnosticReportList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> D</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1186">
                        <a:s>where </a:s>
                        <a:s r="1186">
                           <a:s r="1180">
                              <a:s r="1179">
                                 <a:s r="1178">
                                    <a:s>D</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1179">
                                    <a:s>status</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1180">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s> in </a:s>
                           <a:s r="1181">
                              <a:s>List{</a:s>
                              <a:s r="1182">
                                 <a:s>'final'</a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="1183">
                                 <a:s>'amended'</a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="1184">
                                 <a:s>'corrected'</a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="1185">
                                 <a:s>'appended'</a:s>
                              </a:s>
                              <a:s>}</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1190" locator="341:3-342:77" xsi:type="Query">
            <source localId="1176" locator="341:3-341:24" alias="D">
               <expression localId="1177" locator="341:3-341:22" name="DiagnosticReportList" xsi:type="OperandRef"/>
            </source>
            <where localId="1186" locator="342:5-342:77" xsi:type="In">
               <signature localId="1187" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <signature localId="1188" xsi:type="ListTypeSpecifier">
                  <elementType localId="1189" name="t:String" xsi:type="NamedTypeSpecifier"/>
               </signature>
               <operand localId="1180" locator="342:11-342:24" path="value" xsi:type="Property">
                  <source localId="1179" locator="342:11-342:18" path="status" scope="D" xsi:type="Property"/>
               </operand>
               <operand localId="1181" locator="342:29-342:77" xsi:type="List">
                  <element localId="1182" locator="342:34-342:40" valueType="t:String" value="final" xsi:type="Literal"/>
                  <element localId="1183" locator="342:43-342:51" valueType="t:String" value="amended" xsi:type="Literal"/>
                  <element localId="1184" locator="342:54-342:64" valueType="t:String" value="corrected" xsi:type="Literal"/>
                  <element localId="1185" locator="342:67-342:76" valueType="t:String" value="appended" xsi:type="Literal"/>
               </operand>
            </where>
         </expression>
         <operand localId="1175" name="DiagnosticReportList">
            <operandTypeSpecifier localId="1173" locator="340:64-340:85" xsi:type="ListTypeSpecifier">
               <elementType localId="1174" locator="340:69-340:84" name="fhir:DiagnosticReport" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1191" locator="352:1-356:83" name="LookBack" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1191">
               <a:s>/**
* Medication Administrations that are issued in the specified &quot;look back&quot; period.
* TODO: Rename to LookBack once the execution engine supports overloaded functions.
* @param MedList - a list of MedicationAdministrations
* @param LookBack - the lookback period for when the medication was prescribed
* @returns {List&lt;MedicationAdministration>} a list of MedicationAdministrations prescribed in the look back period, or null if null
* was passed in
*/
define function LookBack(MedList List&lt;MedicationAdministration>, LookBack System.Quantity):
  </a:s>
               <a:s r="1230">
                  <a:s r="1230">
                     <a:s>
                        <a:s r="1197">
                           <a:s r="1198">
                              <a:s>
                                 <a:s>MedList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> M</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s>
                        <a:s>let </a:s>
                        <a:s r="1199">
                           <a:s>LookBackInterval: </a:s>
                           <a:s r="1210">
                              <a:s>Interval[</a:s>
                              <a:s r="1200">
                                 <a:s r="1203">
                                    <a:s>Now()</a:s>
                                 </a:s>
                                 <a:s> - </a:s>
                                 <a:s r="1204">
                                    <a:s>LookBack</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="1209">
                                 <a:s>Now()</a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1211">
                        <a:s>where </a:s>
                        <a:s r="1211">
                           <a:s r="1218">
                              <a:s r="1216">
                                 <a:s r="1212">
                                    <a:s>(</a:s>
                                    <a:s r="1212">
                                       <a:s r="1214">
                                          <a:s r="1213">
                                             <a:s>M</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1214">
                                             <a:s>effective</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> as </a:s>
                                       <a:s r="1215">
                                          <a:s>FHIR.dateTime</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1216">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> in </a:s>
                              <a:s r="1217">
                                 <a:s>LookBackInterval</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      or </a:s>
                           <a:s r="1229">
                              <a:s r="1227">
                                 <a:s r="1222">
                                    <a:s>C3F</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1227">
                                    <a:s>PeriodToInterval(</a:s>
                                    <a:s r="1223">
                                       <a:s r="1225">
                                          <a:s r="1224">
                                             <a:s>M</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1225">
                                             <a:s>effective</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> as </a:s>
                                       <a:s r="1226">
                                          <a:s>FHIR.Period</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s r="1229"> overlaps </a:s>
                              <a:s r="1228">
                                 <a:s>LookBackInterval</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1230" locator="353:3-356:83" xsi:type="Query">
            <source localId="1197" locator="353:3-353:11" alias="M">
               <expression localId="1198" locator="353:3-353:9" name="MedList" xsi:type="OperandRef"/>
            </source>
            <let localId="1199" locator="354:9-354:59" identifier="LookBackInterval">
               <expression localId="1210" locator="354:27-354:59" lowClosed="true" highClosed="true" xsi:type="Interval">
                  <low localId="1200" locator="354:36-354:51" xsi:type="Subtract">
                     <signature localId="1205" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1206" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1203" locator="354:36-354:40" xsi:type="Now"/>
                     <operand localId="1204" locator="354:44-354:51" name="LookBack" xsi:type="OperandRef"/>
                  </low>
                  <high localId="1209" locator="354:54-354:58" xsi:type="Now"/>
               </expression>
            </let>
            <where localId="1211" locator="355:5-356:83" xsi:type="Or">
               <operand localId="1218" locator="355:11-355:66" xsi:type="In">
                  <signature localId="1219" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1220" xsi:type="IntervalTypeSpecifier">
                     <pointType localId="1221" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <operand localId="1216" locator="355:11-355:46" path="value" xsi:type="Property">
                     <source localId="1212" locator="355:11-355:40" strict="false" xsi:type="As">
                        <operand localId="1214" locator="355:12-355:22" path="effective" scope="M" xsi:type="Property"/>
                        <asTypeSpecifier localId="1215" locator="355:27-355:39" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     </source>
                  </operand>
                  <operand localId="1217" locator="355:51-355:66" name="LookBackInterval" xsi:type="QueryLetRef"/>
               </operand>
               <operand localId="1229" locator="356:10-356:83" xsi:type="Overlaps">
                  <operand localId="1227" locator="356:10-356:57" name="PeriodToInterval" libraryName="C3F" xsi:type="FunctionRef">
                     <operand localId="1223" locator="356:31-356:56" strict="false" xsi:type="As">
                        <operand localId="1225" locator="356:31-356:41" path="effective" scope="M" xsi:type="Property"/>
                        <asTypeSpecifier localId="1226" locator="356:46-356:56" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     </operand>
                  </operand>
                  <operand localId="1228" locator="356:68-356:83" name="LookBackInterval" xsi:type="QueryLetRef"/>
               </operand>
            </where>
         </expression>
         <operand localId="1194" name="MedList">
            <operandTypeSpecifier localId="1192" locator="352:34-352:63" xsi:type="ListTypeSpecifier">
               <elementType localId="1193" locator="352:39-352:62" name="fhir:MedicationAdministration" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
         <operand localId="1196" name="LookBack">
            <operandTypeSpecifier localId="1195" locator="352:75-352:89" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1231" locator="364:1-366:38" name="CompletedMedicationRequest" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1231">
               <a:s>/**
* Medication requests that are completed, according to a prescription.
* @see http://hl7.org/fhir/R4/valueset-medicationrequest-status.html
* @param MedList - a list of MedicationRequests
* @returns {List&lt;MedicationRequest>} a list of completed medication requests, or null if null was passed in
*/
define function CompletedMedicationRequest(MedList List&lt;MedicationRequest>):
  </a:s>
               <a:s r="1244">
                  <a:s r="1244">
                     <a:s>
                        <a:s r="1235">
                           <a:s r="1236">
                              <a:s>
                                 <a:s>MedList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> M</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1237">
                        <a:s>where </a:s>
                        <a:s r="1237">
                           <a:s r="1240">
                              <a:s r="1239">
                                 <a:s r="1238">
                                    <a:s>M</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1239">
                                    <a:s>status</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1240">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="1241">
                              <a:s>'completed'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1244" locator="365:3-366:38" xsi:type="Query">
            <source localId="1235" locator="365:3-365:11" alias="M">
               <expression localId="1236" locator="365:3-365:9" name="MedList" xsi:type="OperandRef"/>
            </source>
            <where localId="1237" locator="366:5-366:38" xsi:type="Equal">
               <signature localId="1242" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <signature localId="1243" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand localId="1240" locator="366:11-366:24" path="value" xsi:type="Property">
                  <source localId="1239" locator="366:11-366:18" path="status" scope="M" xsi:type="Property"/>
               </operand>
               <operand localId="1241" locator="366:28-366:38" valueType="t:String" value="completed" xsi:type="Literal"/>
            </where>
         </expression>
         <operand localId="1234" name="MedList">
            <operandTypeSpecifier localId="1232" locator="364:52-364:74" xsi:type="ListTypeSpecifier">
               <elementType localId="1233" locator="364:57-364:73" name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1245" locator="374:1-380:42" name="MedicationRequestsWithOrderIntent" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1245">
               <a:s>/**
* Medication requests with an intent of 'order', or one of the sub-categories of 'order'.
* @see http://hl7.org/fhir/R4/valueset-medicationrequest-intent.html
* @param MedList - a list of MedicationRequests
* @returns {List&lt;MedicationRequest>} a list of medication requests with an intent of 'order', or null if null was passed in
*/
define function MedicationRequestsWithOrderIntent(MedList List&lt;MedicationRequest>):
  </a:s>
               <a:s r="1290">
                  <a:s r="1290">
                     <a:s>
                        <a:s r="1249">
                           <a:s r="1250">
                              <a:s>
                                 <a:s>MedList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> M</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1251">
                        <a:s>where </a:s>
                        <a:s r="1251">
                           <a:s r="1252">
                              <a:s r="1253">
                                 <a:s r="1254">
                                    <a:s r="1255">
                                       <a:s r="1258">
                                          <a:s r="1257">
                                             <a:s r="1256">
                                                <a:s>M</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="1257">
                                                <a:s>intent</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1258">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> = </a:s>
                                       <a:s r="1259">
                                          <a:s>'order'</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
      or </a:s>
                                    <a:s r="1262">
                                       <a:s r="1265">
                                          <a:s r="1264">
                                             <a:s r="1263">
                                                <a:s>M</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="1264">
                                                <a:s>intent</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1265">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> = </a:s>
                                       <a:s r="1266">
                                          <a:s>'original-order'</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
      or </a:s>
                                 <a:s r="1269">
                                    <a:s r="1272">
                                       <a:s r="1271">
                                          <a:s r="1270">
                                             <a:s>M</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="1271">
                                             <a:s>intent</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1272">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> = </a:s>
                                    <a:s r="1273">
                                       <a:s>'reflex-order'</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
      or </a:s>
                              <a:s r="1276">
                                 <a:s r="1279">
                                    <a:s r="1278">
                                       <a:s r="1277">
                                          <a:s>M</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1278">
                                          <a:s>intent</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1279">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> = </a:s>
                                 <a:s r="1280">
                                    <a:s>'filler-order'</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      or </a:s>
                           <a:s r="1283">
                              <a:s r="1286">
                                 <a:s r="1285">
                                    <a:s r="1284">
                                       <a:s>M</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1285">
                                       <a:s>intent</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1286">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> = </a:s>
                              <a:s r="1287">
                                 <a:s>'instance-order'</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1290" locator="375:3-380:42" xsi:type="Query">
            <source localId="1249" locator="375:3-375:11" alias="M">
               <expression localId="1250" locator="375:3-375:9" name="MedList" xsi:type="OperandRef"/>
            </source>
            <where localId="1251" locator="376:5-380:42" xsi:type="Or">
               <operand localId="1252" locator="376:11-379:40" xsi:type="Or">
                  <operand localId="1253" locator="376:11-378:40" xsi:type="Or">
                     <operand localId="1254" locator="376:11-377:42" xsi:type="Or">
                        <operand localId="1255" locator="376:11-376:34" xsi:type="Equal">
                           <signature localId="1260" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <signature localId="1261" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="1258" locator="376:11-376:24" path="value" xsi:type="Property">
                              <source localId="1257" locator="376:11-376:18" path="intent" scope="M" xsi:type="Property"/>
                           </operand>
                           <operand localId="1259" locator="376:28-376:34" valueType="t:String" value="order" xsi:type="Literal"/>
                        </operand>
                        <operand localId="1262" locator="377:10-377:42" xsi:type="Equal">
                           <signature localId="1267" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <signature localId="1268" name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="1265" locator="377:10-377:23" path="value" xsi:type="Property">
                              <source localId="1264" locator="377:10-377:17" path="intent" scope="M" xsi:type="Property"/>
                           </operand>
                           <operand localId="1266" locator="377:27-377:42" valueType="t:String" value="original-order" xsi:type="Literal"/>
                        </operand>
                     </operand>
                     <operand localId="1269" locator="378:10-378:40" xsi:type="Equal">
                        <signature localId="1274" name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="1275" name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1272" locator="378:10-378:23" path="value" xsi:type="Property">
                           <source localId="1271" locator="378:10-378:17" path="intent" scope="M" xsi:type="Property"/>
                        </operand>
                        <operand localId="1273" locator="378:27-378:40" valueType="t:String" value="reflex-order" xsi:type="Literal"/>
                     </operand>
                  </operand>
                  <operand localId="1276" locator="379:10-379:40" xsi:type="Equal">
                     <signature localId="1281" name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <signature localId="1282" name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="1279" locator="379:10-379:23" path="value" xsi:type="Property">
                        <source localId="1278" locator="379:10-379:17" path="intent" scope="M" xsi:type="Property"/>
                     </operand>
                     <operand localId="1280" locator="379:27-379:40" valueType="t:String" value="filler-order" xsi:type="Literal"/>
                  </operand>
               </operand>
               <operand localId="1283" locator="380:10-380:42" xsi:type="Equal">
                  <signature localId="1288" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature localId="1289" name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="1286" locator="380:10-380:23" path="value" xsi:type="Property">
                     <source localId="1285" locator="380:10-380:17" path="intent" scope="M" xsi:type="Property"/>
                  </operand>
                  <operand localId="1287" locator="380:27-380:42" valueType="t:String" value="instance-order" xsi:type="Literal"/>
               </operand>
            </where>
         </expression>
         <operand localId="1248" name="MedList">
            <operandTypeSpecifier localId="1246" locator="374:59-374:81" xsi:type="ListTypeSpecifier">
               <elementType localId="1247" locator="374:64-374:80" name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1291" locator="391:1-396:3" name="ProcedureDate" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1291">
               <a:s>/*******************************************************************************
* Observation Functions
*******************************************************************************/


/*******************************************************************************
* Procedure Functions
*******************************************************************************/

define function ProcedureDate(p FHIR.Procedure):
  </a:s>
               <a:s r="1316">
                  <a:s r="1316">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="1298">
                        <a:s r="1294">
                           <a:s>(</a:s>
                           <a:s r="1294">
                              <a:s r="1296">
                                 <a:s r="1295">
                                    <a:s>p</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1296">
                                    <a:s>performed</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> as </a:s>
                              <a:s r="1297">
                                 <a:s>FHIR.dateTime</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="1298">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="1304">
                        <a:s r="1303">
                           <a:s r="1299">
                              <a:s>(</a:s>
                              <a:s r="1299">
                                 <a:s r="1301">
                                    <a:s r="1300">
                                       <a:s>p</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1301">
                                       <a:s>performed</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="1302">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1303">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="1304">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="1310">
                        <a:s r="1309">
                           <a:s r="1305">
                              <a:s>(</a:s>
                              <a:s r="1305">
                                 <a:s r="1307">
                                    <a:s r="1306">
                                       <a:s>p</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1307">
                                       <a:s>performed</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="1308">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1309">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="1310">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1316" locator="392:3-396:3" xsi:type="Coalesce">
            <signature localId="1317" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <signature localId="1318" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <signature localId="1319" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <operand localId="1298" locator="393:5-393:40" path="value" xsi:type="Property">
               <source localId="1294" locator="393:5-393:34" strict="false" xsi:type="As">
                  <operand localId="1296" locator="393:6-393:16" path="performed" xsi:type="Property">
                     <source localId="1295" locator="393:6" name="p" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="1297" locator="393:21-393:33" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </source>
            </operand>
            <operand localId="1304" locator="394:5-394:44" path="value" xsi:type="Property">
               <source localId="1303" locator="394:5-394:38" path="end" xsi:type="Property">
                  <source localId="1299" locator="394:5-394:32" strict="false" xsi:type="As">
                     <operand localId="1301" locator="394:6-394:16" path="performed" xsi:type="Property">
                        <source localId="1300" locator="394:6" name="p" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="1302" locator="394:21-394:31" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
            <operand localId="1310" locator="395:5-395:46" path="value" xsi:type="Property">
               <source localId="1309" locator="395:5-395:40" path="start" xsi:type="Property">
                  <source localId="1305" locator="395:5-395:32" strict="false" xsi:type="As">
                     <operand localId="1307" locator="395:6-395:16" path="performed" xsi:type="Property">
                        <source localId="1306" locator="395:6" name="p" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="1308" locator="395:21-395:31" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </source>
            </operand>
         </expression>
         <operand localId="1293" name="p">
            <operandTypeSpecifier localId="1292" locator="391:33-391:46" name="fhir:Procedure" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1320" locator="403:1-408:3" name="ProcedureDateString" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1320">
               <a:s>// TODO: Can replace this with an overloaded function
// Returns a text representation of a date associated with a Procedure, preferring `effectiveDateTime`, then
// `.start`.
// @param s - a FHIR Procedure to get the text date from
// @returns {System.String} the text representation of a relevant date from the Procedure
define function ProcedureDateString(p FHIR.Procedure):
  </a:s>
               <a:s r="1345">
                  <a:s r="1345">
                     <a:s>Coalesce(
    </a:s>
                     <a:s r="1327">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="1323">
                           <a:s r="1325">
                              <a:s r="1324">
                                 <a:s>p</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1325">
                                 <a:s>performed</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="1326">
                              <a:s>FHIR.dateTime</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="1333">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="1332">
                           <a:s r="1328">
                              <a:s>(</a:s>
                              <a:s r="1328">
                                 <a:s r="1330">
                                    <a:s r="1329">
                                       <a:s>p</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1330">
                                       <a:s>performed</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="1331">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1332">
                              <a:s>&quot;end&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>,
    </a:s>
                     <a:s r="1339">
                        <a:s>DateTimeText(</a:s>
                        <a:s r="1338">
                           <a:s r="1334">
                              <a:s>(</a:s>
                              <a:s r="1334">
                                 <a:s r="1336">
                                    <a:s r="1335">
                                       <a:s>p</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1336">
                                       <a:s>performed</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="1337">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="1338">
                              <a:s>&quot;start&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1345" locator="404:3-408:3" xsi:type="Coalesce">
            <signature localId="1346" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="1347" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <signature localId="1348" name="t:String" xsi:type="NamedTypeSpecifier"/>
            <operand localId="1327" locator="405:5-405:46" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="1323" locator="405:18-405:45" strict="false" xsi:type="As">
                  <operand localId="1325" locator="405:18-405:28" path="performed" xsi:type="Property">
                     <source localId="1324" locator="405:18" name="p" xsi:type="OperandRef"/>
                  </operand>
                  <asTypeSpecifier localId="1326" locator="405:33-405:45" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </operand>
            </operand>
            <operand localId="1333" locator="406:5-406:52" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="1332" locator="406:18-406:51" path="end" xsi:type="Property">
                  <source localId="1328" locator="406:18-406:45" strict="false" xsi:type="As">
                     <operand localId="1330" locator="406:19-406:29" path="performed" xsi:type="Property">
                        <source localId="1329" locator="406:19" name="p" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="1331" locator="406:34-406:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
            <operand localId="1339" locator="407:5-407:54" name="DateTimeText" xsi:type="FunctionRef">
               <operand localId="1338" locator="407:18-407:53" path="start" xsi:type="Property">
                  <source localId="1334" locator="407:18-407:45" strict="false" xsi:type="As">
                     <operand localId="1336" locator="407:19-407:29" path="performed" xsi:type="Property">
                        <source localId="1335" locator="407:19" name="p" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="1337" locator="407:34-407:44" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </source>
               </operand>
            </operand>
         </expression>
         <operand localId="1322" name="p">
            <operandTypeSpecifier localId="1321" locator="403:39-403:52" name="fhir:Procedure" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="1349" locator="417:1-422:3" name="OldestProcedure" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1349">
               <a:s>/**
 * The oldest procedure.  For each Procedure, this algorithm will use the Coalesce function, which returns the
 * first non-null result from these fields: performedDateTime, performedPeriod.start, performedPeriod.end.
 * The found date will be used to compare Procedures and determine the oldest one.
 * @param ProcList - a list of Procedures
 * @returns {Procedure} the oldest Procedure from the list, or null if null was passed in
 */
define function OldestProcedure(ProcList List&lt;Procedure>):
  </a:s>
               <a:s r="1407">
                  <a:s r="1407">
                     <a:s>First(</a:s>
                     <a:s r="1402">
                        <a:s>
                           <a:s r="1353">
                              <a:s r="1354">
                                 <a:s>
                                    <a:s>ProcList</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> P</a:s>
                           </a:s>
                        </a:s>
                        <a:s> </a:s>
                        <a:s r="1396">
                           <a:s>sort by </a:s>
                           <a:s r="1395">
                              <a:s r="1391">
                                 <a:s>Coalesce(
    </a:s>
                                 <a:s r="1375">
                                    <a:s r="1372">
                                       <a:s>(</a:s>
                                       <a:s r="1372">
                                          <a:s r="1373">
                                             <a:s>performed</a:s>
                                          </a:s>
                                          <a:s> as </a:s>
                                          <a:s r="1374">
                                             <a:s>FHIR.dateTime</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1375">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>,
    </a:s>
                                 <a:s r="1380">
                                    <a:s r="1379">
                                       <a:s r="1376">
                                          <a:s>(</a:s>
                                          <a:s r="1376">
                                             <a:s r="1377">
                                                <a:s>performed</a:s>
                                             </a:s>
                                             <a:s> as </a:s>
                                             <a:s r="1378">
                                                <a:s>FHIR.Period</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1379">
                                          <a:s>&quot;start&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1380">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>,
    </a:s>
                                 <a:s r="1385">
                                    <a:s r="1384">
                                       <a:s r="1381">
                                          <a:s>(</a:s>
                                          <a:s r="1381">
                                             <a:s r="1382">
                                                <a:s>performed</a:s>
                                             </a:s>
                                             <a:s> as </a:s>
                                             <a:s r="1383">
                                                <a:s>FHIR.Period</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="1384">
                                          <a:s>&quot;end&quot;</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="1385">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1407" locator="418:3-422:3" xsi:type="First">
            <signature localId="1408" xsi:type="ListTypeSpecifier">
               <elementType localId="1409" name="fhir:Procedure" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <source localId="1402" locator="418:9-421:43" xsi:type="Query">
               <source localId="1353" locator="418:9-418:18" alias="P">
                  <expression localId="1354" locator="418:9-418:16" name="ProcList" xsi:type="OperandRef"/>
               </source>
               <sort localId="1396" locator="418:20-421:43">
                  <by localId="1395" locator="418:28-421:43" direction="asc" xsi:type="ByExpression">
                     <expression localId="1391" locator="418:28-421:43" xsi:type="Coalesce">
                        <signature localId="1392" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="1393" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        <signature localId="1394" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="1375" locator="419:5-419:38" path="value" xsi:type="Property">
                           <source localId="1372" locator="419:5-419:32" strict="false" xsi:type="As">
                              <operand localId="1373" locator="419:6-419:14" name="performed" xsi:type="IdentifierRef"/>
                              <asTypeSpecifier localId="1374" locator="419:19-419:31" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           </source>
                        </operand>
                        <operand localId="1380" locator="420:5-420:44" path="value" xsi:type="Property">
                           <source localId="1379" locator="420:5-420:38" path="start" xsi:type="Property">
                              <source localId="1376" locator="420:5-420:30" strict="false" xsi:type="As">
                                 <operand localId="1377" locator="420:6-420:14" name="performed" xsi:type="IdentifierRef"/>
                                 <asTypeSpecifier localId="1378" locator="420:19-420:29" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              </source>
                           </source>
                        </operand>
                        <operand localId="1385" locator="421:5-421:42" path="value" xsi:type="Property">
                           <source localId="1384" locator="421:5-421:36" path="end" xsi:type="Property">
                              <source localId="1381" locator="421:5-421:30" strict="false" xsi:type="As">
                                 <operand localId="1382" locator="421:6-421:14" name="performed" xsi:type="IdentifierRef"/>
                                 <asTypeSpecifier localId="1383" locator="421:19-421:29" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              </source>
                           </source>
                        </operand>
                     </expression>
                  </by>
               </sort>
            </source>
         </expression>
         <operand localId="1352" name="ProcList">
            <operandTypeSpecifier localId="1350" locator="417:42-417:56" xsi:type="ListTypeSpecifier">
               <elementType localId="1351" locator="417:47-417:55" name="fhir:Procedure" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1410" locator="432:1-437:3" name="DateOfFirstProcedure" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1410">
               <a:s>/**
 * Date of the oldest procedure in a list.  For each Procedure, this algorithm will use the Coalesce function, which returns the
 * first non-null result from these fields: performedDateTime, performedPeriod.end, performedPeriod.start.
 * The found date will be used to compare Procedures and determine the oldest one. The date of the oldest Procedure
 * will be returned.
 * @param ProcList - a list of Procedures
 * @returns {System.String} the text representation of the Procedure's date
 */
define function DateOfFirstProcedure(ProcList List&lt;Procedure>):
  </a:s>
               <a:s r="1416">
                  <a:s r="1416">
                     <a:s>ProcedureDate(
    </a:s>
                     <a:s r="1415">
                        <a:s>OldestProcedure(
      </a:s>
                        <a:s r="1414">
                           <a:s>ProcList</a:s>
                        </a:s>
                        <a:s>
    )</a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1416" locator="433:3-437:3" name="ProcedureDate" xsi:type="FunctionRef">
            <operand localId="1415" locator="434:5-436:5" name="OldestProcedure" xsi:type="FunctionRef">
               <operand localId="1414" locator="435:7-435:14" name="ProcList" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand localId="1413" name="ProcList">
            <operandTypeSpecifier localId="1411" locator="432:47-432:61" xsi:type="ListTypeSpecifier">
               <elementType localId="1412" locator="432:52-432:60" name="fhir:Procedure" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="1417" locator="449:1-451:38" name="CompletedImmunization" context="Unfiltered" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="1417">
               <a:s>/*******************************************************************************
* Immunization Functions
*******************************************************************************/

/**
* Immunizations that are completed.
* @see http://hl7.org/fhir/R4/valueset-immunization-status.html
* @param ImmunizationList - a list of Immunizations
* @returns {List&lt;Immunization>} a list of completed immunizations, or null if null was passed in
*/
define function CompletedImmunization(ImmunizationList List&lt;Immunization>):
  </a:s>
               <a:s r="1430">
                  <a:s r="1430">
                     <a:s>
                        <a:s r="1421">
                           <a:s r="1422">
                              <a:s>
                                 <a:s>ImmunizationList</a:s>
                              </a:s>
                           </a:s>
                           <a:s> I</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="1423">
                        <a:s>where </a:s>
                        <a:s r="1423">
                           <a:s r="1426">
                              <a:s r="1425">
                                 <a:s r="1424">
                                    <a:s>I</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="1425">
                                    <a:s>status</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="1426">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="1427">
                              <a:s>'completed'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="1430" locator="450:3-451:38" xsi:type="Query">
            <source localId="1421" locator="450:3-450:20" alias="I">
               <expression localId="1422" locator="450:3-450:18" name="ImmunizationList" xsi:type="OperandRef"/>
            </source>
            <where localId="1423" locator="451:5-451:38" xsi:type="Equal">
               <signature localId="1428" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <signature localId="1429" name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand localId="1426" locator="451:11-451:24" path="value" xsi:type="Property">
                  <source localId="1425" locator="451:11-451:18" path="status" scope="I" xsi:type="Property"/>
               </operand>
               <operand localId="1427" locator="451:28-451:38" valueType="t:String" value="completed" xsi:type="Literal"/>
            </where>
         </expression>
         <operand localId="1420" name="ImmunizationList">
            <operandTypeSpecifier localId="1418" locator="449:56-449:73" xsi:type="ListTypeSpecifier">
               <elementType localId="1419" locator="449:61-449:72" name="fhir:Immunization" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
   </statements>
</library>
